##simulations from another tutorial 

##if on a new computer 
## install CRAN Task View for phylogenetics install.packages('ctv')
## library('ctv') install.views('Phylogenetics')
## update.views('Phylogenetics')

## load ape
library(ape)

## simulate a phylogeny (simple) -- gives tree whose tips are not contemporaneous 
tree <- rtree(n = 20)
plot(tree, edge.width = 2)

##to see the structure of the tree
str(tree)

## (I'm going to first set the seed for repeatability)
set.seed(1)
## simulate a birth-death tree using phytools
tree <- pbtree(b = 1, d = 0.2, n = 40)
## stopping criterion is 40 extant species, in this case
plotTree(tree, setEnv = TRUE)

## if you want to extract a clade descended from a particular node
tt62 <- extract.clade(tree, 62)
plotTree(tt62)

##dropping tips (if I end up wanting to drop the tips that I don't have character data for)
## now drop 10 tips from the tree (I'm going to pick them at random)
dtips <- sample(tree$tip.label, 10)
dt <- drop.tip(tree, dtips)
plotTree(dt)
## we could also, say, drop all tips that go extinct before the present
## this is a fun way, but not the only way to do this:
et <- fancyTree(tree, type = "droptip", tip = getExtinct(tree), cex = 0.7)