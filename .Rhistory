all_Lengths = matrix(data=NA,nrow=134,ncol=repetitions)
for (i in 1:repetitions) {
birthRate = runif(1,min=0.001,max=0.15)
extRate = runif(1,min=0.001,max=0.15)
samplRate = runif(1,min=0.146,max=0.262)
scaledTree = cal3TimePaleoPhy(tree = tree,timeData = occurrence, sampRate = samplRate, brRate = birthRate, extRate = extRate, dateTreatment = "minMax", ntrees = 1)
branchLength = scaledTree$edge.length
all_Lengths[,i] = branchLength
}
assign ("all_Lengths",all_Lengths,.Globalenv)
return(all_Lengths)
}
tree_scaler(phylogeny,time_data,100)
rm(list=ls())
raw_phylogeny = read.newick(text = "(((((((((((((((Tyrannosaurus,Tarbosaurus),Daspletosaurus),(Gorgosaurus,Albertosaurus)),Bistahieversor),(Compsognathus,Sinosauropteryx)),(((Giganotosaurus,Acrocanthosaurus),Allosaurus),(Sinraptor,Yangchuanosaurus))),((Suchomimus,Streptospondylus),Piatnitzkysaurus)),Sinosaurus),Ceratosaurus),Dilophosaurus),Liliensternus),(Herrarasaurus,Staurikosaurus)),Eoraptor),(((((((((((((((((((((((((Saurolophus_osborni,Saurolophus_angustirostris),Gryposaurus),(Edmontosaurus_regalis,Edmontosaurus_annectens)),Shantungosaurus),(Brachylophosaurus,Maiasaura)),(((((((Lambeosaurus_lambei,Lambeosaurus_magnicristatus),(Corythosaurus_casuarius,Corythosaurus_intermedius)),Hypacrosaurus_stebingeri),Hypacrosaurus_altispinus),Parasaurolophus),Olorotitan),Tsintaosaurus)),Bactrosaurus),Tethyshadros),Probactrosaurus),(Mantellisaurus,Iguanodon)),Ouranosaurus),Uteodon),Camptosaurus),(Dryosaurus,Dysalotosaurus)),Tenontosaurus),Zalmoxes),Parksosaurus),(Gasparinisaura,Talenkauen)),Thescelosaurus),Hypsilophodon),((((Montanoceratops,Leptoceratops),Protoceratops),(Psittacosaurus_neimongoliensis,Psittacosaurus_mongoliensis)),(Pachycephalosaurus,Prenocephale))),Othnielosaurus),Agilisaurus),Heterodontosaurus)))),Marasuchus);")
phylogeny = collapse.singles(raw_phylogeny)
plot.phylo(phylogeny, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin=T) # These settings are good for displaying this phylogeny - uncluttered text and clear, discernible branches.
phylogeny$tip.label
data = read.table("occurrence__data.txt", sep = "\t", header = T)
taxa = data$TAXON
trochanter_position = data$FTP
body_mass = data$MASS
FAD = data$FAD
LAD = data$LAD
time_data = read.table("time_data.txt", row.names = 1, sep="\t", header = T)
scale_Tree = cal3TimePaleoPhy(phylogeny, time_data, sampRate = 0.01, brRate = 0.01, extRate = 0.01, dateTreatment = "minMax", ntrees=1) # sampling rate = 0.192, and birth and extinction rates calculated as average of 0.001 and 0.15 = 0.0755. Based on Starrfelt and Liow paper.
plot(scale_Tree, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin = T)
tree_scaler = function(tree,occurrence,repetitions) {
all_Lengths = matrix(data=NA,nrow=134,ncol=repetitions)
for (i in 1:repetitions) {
birthRate = runif(1,min=0.001,max=0.15)
extRate = runif(1,min=0.001,max=0.15)
samplRate = runif(1,min=0.146,max=0.262)
scaledTree = cal3TimePaleoPhy(tree = tree,timeData = occurrence, sampRate = samplRate, brRate = birthRate, extRate = extRate, dateTreatment = "minMax", ntrees = 1)
branchLength = scaledTree$edge.length
all_Lengths[,i] = branchLength
}
assign ("all_Lengths",all_Lengths,.GlobalEnv)
return(all_Lengths)
}
tree_scaler(phylogeny,time_data,100)
all_Lengths
rm(list=ls())
raw_phylogeny = read.newick(text = "(((((((((((((((Tyrannosaurus,Tarbosaurus),Daspletosaurus),(Gorgosaurus,Albertosaurus)),Bistahieversor),(Compsognathus,Sinosauropteryx)),(((Giganotosaurus,Acrocanthosaurus),Allosaurus),(Sinraptor,Yangchuanosaurus))),((Suchomimus,Streptospondylus),Piatnitzkysaurus)),Sinosaurus),Ceratosaurus),Dilophosaurus),Liliensternus),(Herrarasaurus,Staurikosaurus)),Eoraptor),(((((((((((((((((((((((((Saurolophus_osborni,Saurolophus_angustirostris),Gryposaurus),(Edmontosaurus_regalis,Edmontosaurus_annectens)),Shantungosaurus),(Brachylophosaurus,Maiasaura)),(((((((Lambeosaurus_lambei,Lambeosaurus_magnicristatus),(Corythosaurus_casuarius,Corythosaurus_intermedius)),Hypacrosaurus_stebingeri),Hypacrosaurus_altispinus),Parasaurolophus),Olorotitan),Tsintaosaurus)),Bactrosaurus),Tethyshadros),Probactrosaurus),(Mantellisaurus,Iguanodon)),Ouranosaurus),Uteodon),Camptosaurus),(Dryosaurus,Dysalotosaurus)),Tenontosaurus),Zalmoxes),Parksosaurus),(Gasparinisaura,Talenkauen)),Thescelosaurus),Hypsilophodon),((((Montanoceratops,Leptoceratops),Protoceratops),(Psittacosaurus_neimongoliensis,Psittacosaurus_mongoliensis)),(Pachycephalosaurus,Prenocephale))),Othnielosaurus),Agilisaurus),Heterodontosaurus)))),Marasuchus);")
phylogeny = collapse.singles(raw_phylogeny)
plot.phylo(phylogeny, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin=T) # These settings are good for displaying this phylogeny - uncluttered text and clear, discernible branches.
phylogeny$tip.label
data = read.table("occurrence__data.txt", sep = "\t", header = T)
taxa = data$TAXON
trochanter_position = data$FTP
body_mass = data$MASS
FAD = data$FAD
LAD = data$LAD
time_data = read.table("time_data.txt", row.names = 1, sep="\t", header = T)
scale_Tree = cal3TimePaleoPhy(phylogeny, time_data, sampRate = 0.01, brRate = 0.01, extRate = 0.01, dateTreatment = "minMax", ntrees=1) # sampling rate = 0.192, and birth and extinction rates calculated as average of 0.001 and 0.15 = 0.0755. Based on Starrfelt and Liow paper.
plot(scale_Tree, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin = T)
tree_scaler = function(tree,occurrence,repetitions) {
all_Lengths = matrix(data=NA,nrow=134,ncol=repetitions)
for (i in 1:repetitions) {
birthRate = runif(1,min=0.001,max=0.15)
extRate = runif(1,min=0.001,max=0.15)
samplRate = runif(1,min=0.146,max=0.262)
scaledTree = cal3TimePaleoPhy(tree = tree,timeData = occurrence, sampRate = samplRate, brRate = birthRate, extRate = extRate, dateTreatment = "minMax", ntrees = 1)
branchLength = scaledTree$edge.length
all_Lengths[,i] = branchLength
}
assign ("all_Lengths",all_Lengths,.GlobalEnv)
return(all_Lengths)
}
tree_scaler(phylogeny,time_data,100)
rm(list=ls())
raw_phylogeny = read.newick(text = "(((((((((((((((Tyrannosaurus,Tarbosaurus),Daspletosaurus),(Gorgosaurus,Albertosaurus)),Bistahieversor),(Compsognathus,Sinosauropteryx)),(((Giganotosaurus,Acrocanthosaurus),Allosaurus),(Sinraptor,Yangchuanosaurus))),((Suchomimus,Streptospondylus),Piatnitzkysaurus)),Sinosaurus),Ceratosaurus),Dilophosaurus),Liliensternus),(Herrarasaurus,Staurikosaurus)),Eoraptor),(((((((((((((((((((((((((Saurolophus_osborni,Saurolophus_angustirostris),Gryposaurus),(Edmontosaurus_regalis,Edmontosaurus_annectens)),Shantungosaurus),(Brachylophosaurus,Maiasaura)),(((((((Lambeosaurus_lambei,Lambeosaurus_magnicristatus),(Corythosaurus_casuarius,Corythosaurus_intermedius)),Hypacrosaurus_stebingeri),Hypacrosaurus_altispinus),Parasaurolophus),Olorotitan),Tsintaosaurus)),Bactrosaurus),Tethyshadros),Probactrosaurus),(Mantellisaurus,Iguanodon)),Ouranosaurus),Uteodon),Camptosaurus),(Dryosaurus,Dysalotosaurus)),Tenontosaurus),Zalmoxes),Parksosaurus),(Gasparinisaura,Talenkauen)),Thescelosaurus),Hypsilophodon),((((Montanoceratops,Leptoceratops),Protoceratops),(Psittacosaurus_neimongoliensis,Psittacosaurus_mongoliensis)),(Pachycephalosaurus,Prenocephale))),Othnielosaurus),Agilisaurus),Heterodontosaurus)))),Marasuchus);")
phylogeny = collapse.singles(raw_phylogeny)
plot.phylo(phylogeny, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin=T) # These settings are good for displaying this phylogeny - uncluttered text and clear, discernible branches.
phylogeny$tip.label
data = read.table("occurrence__data.txt", sep = "\t", header = T)
taxa = data$TAXON
trochanter_position = data$FTP
body_mass = data$MASS
FAD = data$FAD
LAD = data$LAD
time_data = read.table("time_data.txt", row.names = 1, sep="\t", header = T)
scale_Tree = cal3TimePaleoPhy(phylogeny, time_data, sampRate = 0.01, brRate = 0.01, extRate = 0.01, dateTreatment = "minMax", ntrees=1) # sampling rate = 0.192, and birth and extinction rates calculated as average of 0.001 and 0.15 = 0.0755. Based on Starrfelt and Liow paper.
plot(scale_Tree, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin = T)
tree_scaler = function(tree,occurrence,repetitions) {
all_Lengths = matrix(data=NA,nrow=134,ncol=repetitions)
for (i in 1:repetitions) {
birthRate = runif(1,min=0.001,max=0.15)
extRate = runif(1,min=0.001,max=0.15)
samplRate = runif(1,min=0.146,max=0.262)
scaledTree = cal3TimePaleoPhy(tree = tree,timeData = occurrence, sampRate = samplRate, brRate = birthRate, extRate = extRate, dateTreatment = "minMax", ntrees = 1)
branchLength = scaledTree$edge.length
all_Lengths[,i] = branchLength
}
assign ("all_Lengths",all_Lengths,.GlobalEnv)
return(all_Lengths)
}
tree_scaler(phylogeny,time_data,100)
for (i in 1:nrow(all_Lengths)) {
Counter = 0
avg_Length = matrix (data=NA,nrow=134,ncol=1)
for (j in 1:ncol(all_Lengths)) {
all_Length[i,j] = A_Val
Counter = Counter + A_Val
}
assign ("avg_Length",avg_Length,.GlobalEnv)
avg_Length[i,] = Counter/ncol(all_Lengths)
}
rm(list=ls())
raw_phylogeny = read.newick(text = "(((((((((((((((Tyrannosaurus,Tarbosaurus),Daspletosaurus),(Gorgosaurus,Albertosaurus)),Bistahieversor),(Compsognathus,Sinosauropteryx)),(((Giganotosaurus,Acrocanthosaurus),Allosaurus),(Sinraptor,Yangchuanosaurus))),((Suchomimus,Streptospondylus),Piatnitzkysaurus)),Sinosaurus),Ceratosaurus),Dilophosaurus),Liliensternus),(Herrarasaurus,Staurikosaurus)),Eoraptor),(((((((((((((((((((((((((Saurolophus_osborni,Saurolophus_angustirostris),Gryposaurus),(Edmontosaurus_regalis,Edmontosaurus_annectens)),Shantungosaurus),(Brachylophosaurus,Maiasaura)),(((((((Lambeosaurus_lambei,Lambeosaurus_magnicristatus),(Corythosaurus_casuarius,Corythosaurus_intermedius)),Hypacrosaurus_stebingeri),Hypacrosaurus_altispinus),Parasaurolophus),Olorotitan),Tsintaosaurus)),Bactrosaurus),Tethyshadros),Probactrosaurus),(Mantellisaurus,Iguanodon)),Ouranosaurus),Uteodon),Camptosaurus),(Dryosaurus,Dysalotosaurus)),Tenontosaurus),Zalmoxes),Parksosaurus),(Gasparinisaura,Talenkauen)),Thescelosaurus),Hypsilophodon),((((Montanoceratops,Leptoceratops),Protoceratops),(Psittacosaurus_neimongoliensis,Psittacosaurus_mongoliensis)),(Pachycephalosaurus,Prenocephale))),Othnielosaurus),Agilisaurus),Heterodontosaurus)))),Marasuchus);")
phylogeny = collapse.singles(raw_phylogeny)
plot.phylo(phylogeny, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin=T) # These settings are good for displaying this phylogeny - uncluttered text and clear, discernible branches.
phylogeny$tip.label
data = read.table("occurrence__data.txt", sep = "\t", header = T)
taxa = data$TAXON
trochanter_position = data$FTP
body_mass = data$MASS
FAD = data$FAD
LAD = data$LAD
time_data = read.table("time_data.txt", row.names = 1, sep="\t", header = T)
scale_Tree = cal3TimePaleoPhy(phylogeny, time_data, sampRate = 0.01, brRate = 0.01, extRate = 0.01, dateTreatment = "minMax", ntrees=1) # sampling rate = 0.192, and birth and extinction rates calculated as average of 0.001 and 0.15 = 0.0755. Based on Starrfelt and Liow paper.
plot(scale_Tree, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin = T)
tree_scaler = function(tree,occurrence,repetitions) {
all_Lengths = matrix(data=NA,nrow=134,ncol=repetitions)
for (i in 1:repetitions) {
birthRate = runif(1,min=0.001,max=0.15)
extRate = runif(1,min=0.001,max=0.15)
samplRate = runif(1,min=0.146,max=0.262)
scaledTree = cal3TimePaleoPhy(tree = tree,timeData = occurrence, sampRate = samplRate, brRate = birthRate, extRate = extRate, dateTreatment = "minMax", ntrees = 1)
branchLength = scaledTree$edge.length
all_Lengths[,i] = branchLength
}
assign ("all_Lengths",all_Lengths,.GlobalEnv)
return(all_Lengths)
}
tree_scaler(phylogeny,time_data,100)
for (i in 1:nrow(all_Lengths)) {
Counter = 0
avg_Length = matrix (data=NA,nrow=134,ncol=1)
for (j in 1:ncol(all_Lengths)) {
A_Val = 0
all_Length[i,j] = A_Val
Counter = Counter + A_Val
}
assign ("avg_Length",avg_Length,.GlobalEnv)
avg_Length[i,] = Counter/ncol(all_Lengths)
}
rm(list=ls())
raw_phylogeny = read.newick(text = "(((((((((((((((Tyrannosaurus,Tarbosaurus),Daspletosaurus),(Gorgosaurus,Albertosaurus)),Bistahieversor),(Compsognathus,Sinosauropteryx)),(((Giganotosaurus,Acrocanthosaurus),Allosaurus),(Sinraptor,Yangchuanosaurus))),((Suchomimus,Streptospondylus),Piatnitzkysaurus)),Sinosaurus),Ceratosaurus),Dilophosaurus),Liliensternus),(Herrarasaurus,Staurikosaurus)),Eoraptor),(((((((((((((((((((((((((Saurolophus_osborni,Saurolophus_angustirostris),Gryposaurus),(Edmontosaurus_regalis,Edmontosaurus_annectens)),Shantungosaurus),(Brachylophosaurus,Maiasaura)),(((((((Lambeosaurus_lambei,Lambeosaurus_magnicristatus),(Corythosaurus_casuarius,Corythosaurus_intermedius)),Hypacrosaurus_stebingeri),Hypacrosaurus_altispinus),Parasaurolophus),Olorotitan),Tsintaosaurus)),Bactrosaurus),Tethyshadros),Probactrosaurus),(Mantellisaurus,Iguanodon)),Ouranosaurus),Uteodon),Camptosaurus),(Dryosaurus,Dysalotosaurus)),Tenontosaurus),Zalmoxes),Parksosaurus),(Gasparinisaura,Talenkauen)),Thescelosaurus),Hypsilophodon),((((Montanoceratops,Leptoceratops),Protoceratops),(Psittacosaurus_neimongoliensis,Psittacosaurus_mongoliensis)),(Pachycephalosaurus,Prenocephale))),Othnielosaurus),Agilisaurus),Heterodontosaurus)))),Marasuchus);")
phylogeny = collapse.singles(raw_phylogeny)
plot.phylo(phylogeny, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin=T) # These settings are good for displaying this phylogeny - uncluttered text and clear, discernible branches.
phylogeny$tip.label
data = read.table("occurrence__data.txt", sep = "\t", header = T)
taxa = data$TAXON
trochanter_position = data$FTP
body_mass = data$MASS
FAD = data$FAD
LAD = data$LAD
time_data = read.table("time_data.txt", row.names = 1, sep="\t", header = T)
scale_Tree = cal3TimePaleoPhy(phylogeny, time_data, sampRate = 0.01, brRate = 0.01, extRate = 0.01, dateTreatment = "minMax", ntrees=1) # sampling rate = 0.192, and birth and extinction rates calculated as average of 0.001 and 0.15 = 0.0755. Based on Starrfelt and Liow paper.
plot(scale_Tree, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin = T)
tree_scaler = function(tree,occurrence,repetitions) {
all_Lengths = matrix(data=NA,nrow=134,ncol=repetitions)
for (i in 1:repetitions) {
birthRate = runif(1,min=0.001,max=0.15)
extRate = runif(1,min=0.001,max=0.15)
samplRate = runif(1,min=0.146,max=0.262)
scaledTree = cal3TimePaleoPhy(tree = tree,timeData = occurrence, sampRate = samplRate, brRate = birthRate, extRate = extRate, dateTreatment = "minMax", ntrees = 1)
branchLength = scaledTree$edge.length
all_Lengths[,i] = branchLength
}
assign ("all_Lengths",all_Lengths,.GlobalEnv)
return(all_Lengths)
}
tree_scaler(phylogeny,time_data,100)
for (i in 1:nrow(all_Lengths)) {
Counter = 0
avg_Length = matrix (data=NA,nrow=134,ncol=1)
for (j in 1:ncol(all_Lengths)) {
A_Val = 0
all_Lengths[i,j] = A_Val
Counter = Counter + A_Val
}
assign ("avg_Length",avg_Length,.GlobalEnv)
avg_Length[i,] = Counter/ncol(all_Lengths)
}
avg_Length
rm(list=ls())
raw_phylogeny = read.newick(text = "(((((((((((((((Tyrannosaurus,Tarbosaurus),Daspletosaurus),(Gorgosaurus,Albertosaurus)),Bistahieversor),(Compsognathus,Sinosauropteryx)),(((Giganotosaurus,Acrocanthosaurus),Allosaurus),(Sinraptor,Yangchuanosaurus))),((Suchomimus,Streptospondylus),Piatnitzkysaurus)),Sinosaurus),Ceratosaurus),Dilophosaurus),Liliensternus),(Herrarasaurus,Staurikosaurus)),Eoraptor),(((((((((((((((((((((((((Saurolophus_osborni,Saurolophus_angustirostris),Gryposaurus),(Edmontosaurus_regalis,Edmontosaurus_annectens)),Shantungosaurus),(Brachylophosaurus,Maiasaura)),(((((((Lambeosaurus_lambei,Lambeosaurus_magnicristatus),(Corythosaurus_casuarius,Corythosaurus_intermedius)),Hypacrosaurus_stebingeri),Hypacrosaurus_altispinus),Parasaurolophus),Olorotitan),Tsintaosaurus)),Bactrosaurus),Tethyshadros),Probactrosaurus),(Mantellisaurus,Iguanodon)),Ouranosaurus),Uteodon),Camptosaurus),(Dryosaurus,Dysalotosaurus)),Tenontosaurus),Zalmoxes),Parksosaurus),(Gasparinisaura,Talenkauen)),Thescelosaurus),Hypsilophodon),((((Montanoceratops,Leptoceratops),Protoceratops),(Psittacosaurus_neimongoliensis,Psittacosaurus_mongoliensis)),(Pachycephalosaurus,Prenocephale))),Othnielosaurus),Agilisaurus),Heterodontosaurus)))),Marasuchus);")
phylogeny = collapse.singles(raw_phylogeny)
plot.phylo(phylogeny, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin=T) # These settings are good for displaying this phylogeny - uncluttered text and clear, discernible branches.
phylogeny$tip.label
data = read.table("occurrence__data.txt", sep = "\t", header = T)
taxa = data$TAXON
trochanter_position = data$FTP
body_mass = data$MASS
FAD = data$FAD
LAD = data$LAD
time_data = read.table("time_data.txt", row.names = 1, sep="\t", header = T)
scale_Tree = cal3TimePaleoPhy(phylogeny, time_data, sampRate = 0.01, brRate = 0.01, extRate = 0.01, dateTreatment = "minMax", ntrees=1) # sampling rate = 0.192, and birth and extinction rates calculated as average of 0.001 and 0.15 = 0.0755. Based on Starrfelt and Liow paper.
plot(scale_Tree, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin = T)
tree_scaler = function(tree,occurrence,repetitions) {
all_Lengths = matrix(data=NA,nrow=134,ncol=repetitions)
for (i in 1:repetitions) {
birthRate = runif(1,min=0.001,max=0.15)
extRate = runif(1,min=0.001,max=0.15)
samplRate = runif(1,min=0.146,max=0.262)
scaledTree = cal3TimePaleoPhy(tree = tree,timeData = occurrence, sampRate = samplRate, brRate = birthRate, extRate = extRate, dateTreatment = "minMax", ntrees = 1)
branchLength = scaledTree$edge.length
all_Lengths[,i] = branchLength
}
assign ("all_Lengths",all_Lengths,.GlobalEnv)
return(all_Lengths)
}
tree_scaler(phylogeny,time_data,100)
avg_Length = matrix (data=NA,nrow=134,ncol=1)
for (i in 1:nrow(all_Lengths)) {
Counter = 0
for (j in 1:ncol(all_Lengths)) {
A_Val = 0
all_Lengths[i,j] = A_Val
Counter = Counter + A_Val
}
assign ("avg_Length",avg_Length,.GlobalEnv)
avg_Length[i,] = Counter/ncol(all_Lengths)
return(avg_Length)
}
rm(list=ls())
raw_phylogeny = read.newick(text = "(((((((((((((((Tyrannosaurus,Tarbosaurus),Daspletosaurus),(Gorgosaurus,Albertosaurus)),Bistahieversor),(Compsognathus,Sinosauropteryx)),(((Giganotosaurus,Acrocanthosaurus),Allosaurus),(Sinraptor,Yangchuanosaurus))),((Suchomimus,Streptospondylus),Piatnitzkysaurus)),Sinosaurus),Ceratosaurus),Dilophosaurus),Liliensternus),(Herrarasaurus,Staurikosaurus)),Eoraptor),(((((((((((((((((((((((((Saurolophus_osborni,Saurolophus_angustirostris),Gryposaurus),(Edmontosaurus_regalis,Edmontosaurus_annectens)),Shantungosaurus),(Brachylophosaurus,Maiasaura)),(((((((Lambeosaurus_lambei,Lambeosaurus_magnicristatus),(Corythosaurus_casuarius,Corythosaurus_intermedius)),Hypacrosaurus_stebingeri),Hypacrosaurus_altispinus),Parasaurolophus),Olorotitan),Tsintaosaurus)),Bactrosaurus),Tethyshadros),Probactrosaurus),(Mantellisaurus,Iguanodon)),Ouranosaurus),Uteodon),Camptosaurus),(Dryosaurus,Dysalotosaurus)),Tenontosaurus),Zalmoxes),Parksosaurus),(Gasparinisaura,Talenkauen)),Thescelosaurus),Hypsilophodon),((((Montanoceratops,Leptoceratops),Protoceratops),(Psittacosaurus_neimongoliensis,Psittacosaurus_mongoliensis)),(Pachycephalosaurus,Prenocephale))),Othnielosaurus),Agilisaurus),Heterodontosaurus)))),Marasuchus);")
phylogeny = collapse.singles(raw_phylogeny)
plot.phylo(phylogeny, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin=T) # These settings are good for displaying this phylogeny - uncluttered text and clear, discernible branches.
phylogeny$tip.label
data = read.table("occurrence__data.txt", sep = "\t", header = T)
taxa = data$TAXON
trochanter_position = data$FTP
body_mass = data$MASS
FAD = data$FAD
LAD = data$LAD
time_data = read.table("time_data.txt", row.names = 1, sep="\t", header = T)
scale_Tree = cal3TimePaleoPhy(phylogeny, time_data, sampRate = 0.01, brRate = 0.01, extRate = 0.01, dateTreatment = "minMax", ntrees=1) # sampling rate = 0.192, and birth and extinction rates calculated as average of 0.001 and 0.15 = 0.0755. Based on Starrfelt and Liow paper.
plot(scale_Tree, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin = T)
tree_scaler = function(tree,occurrence,repetitions) {
all_Lengths = matrix(data=NA,nrow=134,ncol=repetitions)
for (i in 1:repetitions) {
birthRate = runif(1,min=0.001,max=0.15)
extRate = runif(1,min=0.001,max=0.15)
samplRate = runif(1,min=0.146,max=0.262)
scaledTree = cal3TimePaleoPhy(tree = tree,timeData = occurrence, sampRate = samplRate, brRate = birthRate, extRate = extRate, dateTreatment = "minMax", ntrees = 1)
branchLength = scaledTree$edge.length
all_Lengths[,i] = branchLength
}
assign ("all_Lengths",all_Lengths,.GlobalEnv)
return(all_Lengths)
}
tree_scaler(phylogeny,time_data,100)
avg_Length = matrix (data=NA,nrow=134,ncol=1)
for (i in 1:nrow(all_Lengths)) {
Counter = 0
for (j in 1:ncol(all_Lengths)) {
A_Val = 0
all_Lengths[i,j] = A_Val
Counter = Counter + A_Val
}
assign ("avg_Length",avg_Length,.GlobalEnv)
avg_Length[i,] = Counter/ncol(all_Lengths)
}
avg_Length
rm(list=ls())
raw_phylogeny = read.newick(text = "(((((((((((((((Tyrannosaurus,Tarbosaurus),Daspletosaurus),(Gorgosaurus,Albertosaurus)),Bistahieversor),(Compsognathus,Sinosauropteryx)),(((Giganotosaurus,Acrocanthosaurus),Allosaurus),(Sinraptor,Yangchuanosaurus))),((Suchomimus,Streptospondylus),Piatnitzkysaurus)),Sinosaurus),Ceratosaurus),Dilophosaurus),Liliensternus),(Herrarasaurus,Staurikosaurus)),Eoraptor),(((((((((((((((((((((((((Saurolophus_osborni,Saurolophus_angustirostris),Gryposaurus),(Edmontosaurus_regalis,Edmontosaurus_annectens)),Shantungosaurus),(Brachylophosaurus,Maiasaura)),(((((((Lambeosaurus_lambei,Lambeosaurus_magnicristatus),(Corythosaurus_casuarius,Corythosaurus_intermedius)),Hypacrosaurus_stebingeri),Hypacrosaurus_altispinus),Parasaurolophus),Olorotitan),Tsintaosaurus)),Bactrosaurus),Tethyshadros),Probactrosaurus),(Mantellisaurus,Iguanodon)),Ouranosaurus),Uteodon),Camptosaurus),(Dryosaurus,Dysalotosaurus)),Tenontosaurus),Zalmoxes),Parksosaurus),(Gasparinisaura,Talenkauen)),Thescelosaurus),Hypsilophodon),((((Montanoceratops,Leptoceratops),Protoceratops),(Psittacosaurus_neimongoliensis,Psittacosaurus_mongoliensis)),(Pachycephalosaurus,Prenocephale))),Othnielosaurus),Agilisaurus),Heterodontosaurus)))),Marasuchus);")
phylogeny = collapse.singles(raw_phylogeny)
plot.phylo(phylogeny, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin=T) # These settings are good for displaying this phylogeny - uncluttered text and clear, discernible branches.
phylogeny$tip.label
data = read.table("occurrence__data.txt", sep = "\t", header = T)
taxa = data$TAXON
trochanter_position = data$FTP
body_mass = data$MASS
FAD = data$FAD
LAD = data$LAD
time_data = read.table("time_data.txt", row.names = 1, sep="\t", header = T)
scale_Tree = cal3TimePaleoPhy(phylogeny, time_data, sampRate = 0.01, brRate = 0.01, extRate = 0.01, dateTreatment = "minMax", ntrees=1) # sampling rate = 0.192, and birth and extinction rates calculated as average of 0.001 and 0.15 = 0.0755. Based on Starrfelt and Liow paper.
plot(scale_Tree, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin = T)
tree_scaler = function(tree,occurrence,repetitions) {
all_Lengths = matrix(data=NA,nrow=134,ncol=repetitions)
for (i in 1:repetitions) {
birthRate = runif(1,min=0.001,max=0.15)
extRate = runif(1,min=0.001,max=0.15)
samplRate = runif(1,min=0.146,max=0.262)
scaledTree = cal3TimePaleoPhy(tree = tree,timeData = occurrence, sampRate = samplRate, brRate = birthRate, extRate = extRate, dateTreatment = "minMax", ntrees = 1)
branchLength = scaledTree$edge.length
all_Lengths[,i] = branchLength
}
assign ("all_Lengths",all_Lengths,.GlobalEnv)
return(all_Lengths)
}
tree_scaler(phylogeny,time_data,100)
avg_Length = matrix (data=NA,nrow=134,ncol=1)
#edge_averager = function (data_matrix)
for (row in 1:nrow(all_Lengths)) {
Counter = 0
for (col in 1:ncol(all_Lengths)) {
A_Val = 0
all_Lengths[i,j] = A_Val
Counter = Counter + A_Val
}
assign ("avg_Length",avg_Length,.GlobalEnv)
avg_Length[i,] = Counter/ncol(all_Lengths)
}
rm(list=ls())
raw_phylogeny = read.newick(text = "(((((((((((((((Tyrannosaurus,Tarbosaurus),Daspletosaurus),(Gorgosaurus,Albertosaurus)),Bistahieversor),(Compsognathus,Sinosauropteryx)),(((Giganotosaurus,Acrocanthosaurus),Allosaurus),(Sinraptor,Yangchuanosaurus))),((Suchomimus,Streptospondylus),Piatnitzkysaurus)),Sinosaurus),Ceratosaurus),Dilophosaurus),Liliensternus),(Herrarasaurus,Staurikosaurus)),Eoraptor),(((((((((((((((((((((((((Saurolophus_osborni,Saurolophus_angustirostris),Gryposaurus),(Edmontosaurus_regalis,Edmontosaurus_annectens)),Shantungosaurus),(Brachylophosaurus,Maiasaura)),(((((((Lambeosaurus_lambei,Lambeosaurus_magnicristatus),(Corythosaurus_casuarius,Corythosaurus_intermedius)),Hypacrosaurus_stebingeri),Hypacrosaurus_altispinus),Parasaurolophus),Olorotitan),Tsintaosaurus)),Bactrosaurus),Tethyshadros),Probactrosaurus),(Mantellisaurus,Iguanodon)),Ouranosaurus),Uteodon),Camptosaurus),(Dryosaurus,Dysalotosaurus)),Tenontosaurus),Zalmoxes),Parksosaurus),(Gasparinisaura,Talenkauen)),Thescelosaurus),Hypsilophodon),((((Montanoceratops,Leptoceratops),Protoceratops),(Psittacosaurus_neimongoliensis,Psittacosaurus_mongoliensis)),(Pachycephalosaurus,Prenocephale))),Othnielosaurus),Agilisaurus),Heterodontosaurus)))),Marasuchus);")
phylogeny = collapse.singles(raw_phylogeny)
plot.phylo(phylogeny, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin=T) # These settings are good for displaying this phylogeny - uncluttered text and clear, discernible branches.
phylogeny$tip.label
rm(list=ls())
raw_phylogeny = read.newick(text = "(((((((((((((((Tyrannosaurus,Tarbosaurus),Daspletosaurus),(Gorgosaurus,Albertosaurus)),Bistahieversor),(Compsognathus,Sinosauropteryx)),(((Giganotosaurus,Acrocanthosaurus),Allosaurus),(Sinraptor,Yangchuanosaurus))),((Suchomimus,Streptospondylus),Piatnitzkysaurus)),Sinosaurus),Ceratosaurus),Dilophosaurus),Liliensternus),(Herrarasaurus,Staurikosaurus)),Eoraptor),(((((((((((((((((((((((((Saurolophus_osborni,Saurolophus_angustirostris),Gryposaurus),(Edmontosaurus_regalis,Edmontosaurus_annectens)),Shantungosaurus),(Brachylophosaurus,Maiasaura)),(((((((Lambeosaurus_lambei,Lambeosaurus_magnicristatus),(Corythosaurus_casuarius,Corythosaurus_intermedius)),Hypacrosaurus_stebingeri),Hypacrosaurus_altispinus),Parasaurolophus),Olorotitan),Tsintaosaurus)),Bactrosaurus),Tethyshadros),Probactrosaurus),(Mantellisaurus,Iguanodon)),Ouranosaurus),Uteodon),Camptosaurus),(Dryosaurus,Dysalotosaurus)),Tenontosaurus),Zalmoxes),Parksosaurus),(Gasparinisaura,Talenkauen)),Thescelosaurus),Hypsilophodon),((((Montanoceratops,Leptoceratops),Protoceratops),(Psittacosaurus_neimongoliensis,Psittacosaurus_mongoliensis)),(Pachycephalosaurus,Prenocephale))),Othnielosaurus),Agilisaurus),Heterodontosaurus)))),Marasuchus);")
phylogeny = collapse.singles(raw_phylogeny)
plot.phylo(phylogeny, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin=T) # These settings are good for displaying this phylogeny - uncluttered text and clear, discernible branches.
phylogeny$tip.label
data = read.table("occurrence__data.txt", sep = "\t", header = T)
taxa = data$TAXON
trochanter_position = data$FTP
body_mass = data$MASS
FAD = data$FAD
LAD = data$LAD
time_data = read.table("time_data.txt", row.names = 1, sep="\t", header = T)
scale_Tree = cal3TimePaleoPhy(phylogeny, time_data, sampRate = 0.01, brRate = 0.01, extRate = 0.01, dateTreatment = "minMax", ntrees=1) # sampling rate = 0.192, and birth and extinction rates calculated as average of 0.001 and 0.15 = 0.0755. Based on Starrfelt and Liow paper.
plot(scale_Tree, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin = T)
tree_scaler = function(tree,occurrence,repetitions) {
all_Lengths = matrix(data=NA,nrow=134,ncol=repetitions)
for (i in 1:repetitions) {
birthRate = runif(1,min=0.001,max=0.15)
extRate = runif(1,min=0.001,max=0.15)
samplRate = runif(1,min=0.146,max=0.262)
scaledTree = cal3TimePaleoPhy(tree = tree,timeData = occurrence, sampRate = samplRate, brRate = birthRate, extRate = extRate, dateTreatment = "minMax", ntrees = 1)
branchLength = scaledTree$edge.length
all_Lengths[,i] = branchLength
}
assign ("all_Lengths",all_Lengths,.GlobalEnv)
return(all_Lengths)
}
tree_scaler(phylogeny,time_data,100)
avg_Lengths = rowMeans (all_Lengths,na.rm=FALSE,dims=1)
avg_Lengths
plot(phylogeny, edge.length = avg_Lengths, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin = T)
plot(phylogeny, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin = T)
rm(list=ls())
raw_phylogeny = read.newick(text = "(((((((((((((((Tyrannosaurus,Tarbosaurus),Daspletosaurus),(Gorgosaurus,Albertosaurus)),Bistahieversor),(Compsognathus,Sinosauropteryx)),(((Giganotosaurus,Acrocanthosaurus),Allosaurus),(Sinraptor,Yangchuanosaurus))),((Suchomimus,Streptospondylus),Piatnitzkysaurus)),Sinosaurus),Ceratosaurus),Dilophosaurus),Liliensternus),(Herrarasaurus,Staurikosaurus)),Eoraptor),(((((((((((((((((((((((((Saurolophus_osborni,Saurolophus_angustirostris),Gryposaurus),(Edmontosaurus_regalis,Edmontosaurus_annectens)),Shantungosaurus),(Brachylophosaurus,Maiasaura)),(((((((Lambeosaurus_lambei,Lambeosaurus_magnicristatus),(Corythosaurus_casuarius,Corythosaurus_intermedius)),Hypacrosaurus_stebingeri),Hypacrosaurus_altispinus),Parasaurolophus),Olorotitan),Tsintaosaurus)),Bactrosaurus),Tethyshadros),Probactrosaurus),(Mantellisaurus,Iguanodon)),Ouranosaurus),Uteodon),Camptosaurus),(Dryosaurus,Dysalotosaurus)),Tenontosaurus),Zalmoxes),Parksosaurus),(Gasparinisaura,Talenkauen)),Thescelosaurus),Hypsilophodon),((((Montanoceratops,Leptoceratops),Protoceratops),(Psittacosaurus_neimongoliensis,Psittacosaurus_mongoliensis)),(Pachycephalosaurus,Prenocephale))),Othnielosaurus),Agilisaurus),Heterodontosaurus)))),Marasuchus);")
phylogeny = collapse.singles(raw_phylogeny)
plot.phylo(phylogeny, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin=T) # These settings are good for displaying this phylogeny - uncluttered text and clear, discernible branches.
phylogeny$tip.label
data = read.table("occurrence__data.txt", sep = "\t", header = T)
taxa = data$TAXON
trochanter_position = data$FTP
body_mass = data$MASS
FAD = data$FAD
LAD = data$LAD
time_data = read.table("time_data.txt", row.names = 1, sep="\t", header = T)
scale_Tree = cal3TimePaleoPhy(phylogeny, time_data, sampRate = 0.01, brRate = 0.01, extRate = 0.01, dateTreatment = "minMax", ntrees=1) # sampling rate = 0.192, and birth and extinction rates calculated as average of 0.001 and 0.15 = 0.0755. Based on Starrfelt and Liow paper.
plot(scale_Tree, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin = T)
tree_scaler = function(tree,occurrence,repetitions) {
all_Lengths = matrix(data=NA,nrow=134,ncol=repetitions)
for (i in 1:repetitions) {
birthRate = runif(1,min=0.001,max=0.15)
extRate = runif(1,min=0.001,max=0.15)
samplRate = runif(1,min=0.146,max=0.262)
scaledTree = cal3TimePaleoPhy(tree = tree,timeData = occurrence, sampRate = samplRate, brRate = birthRate, extRate = extRate, dateTreatment = "minMax", ntrees = 1)
branchLength = scaledTree$edge.length
all_Lengths[,i] = branchLength
}
assign ("all_Lengths",all_Lengths,.GlobalEnv)
return(all_Lengths)
}
tree_scaler(phylogeny,time_data,3)
avg_Lengths = rowMeans (all_Lengths,na.rm=FALSE,dims=1)
avg_Lengths
rm(list=ls()) #Clears pre-existing variables
# Loading required packages for session:
library(ape)
library(picante)
library(paleotree)
library(phytools)
# Reading phylogeny of taxa of interest:
raw_phylogeny = read.newick(text = "(((((((((((((((Tyrannosaurus,Tarbosaurus),Daspletosaurus),(Gorgosaurus,Albertosaurus)),Bistahieversor),(Compsognathus,Sinosauropteryx)),(((Giganotosaurus,Acrocanthosaurus),Allosaurus),(Sinraptor,Yangchuanosaurus))),((Suchomimus,Streptospondylus),Piatnitzkysaurus)),Sinosaurus),Ceratosaurus),Dilophosaurus),Liliensternus),(Herrarasaurus,Staurikosaurus)),Eoraptor),(((((((((((((((((((((((((Saurolophus_osborni,Saurolophus_angustirostris),Gryposaurus),(Edmontosaurus_regalis,Edmontosaurus_annectens)),Shantungosaurus),(Brachylophosaurus,Maiasaura)),(((((((Lambeosaurus_lambei,Lambeosaurus_magnicristatus),(Corythosaurus_casuarius,Corythosaurus_intermedius)),Hypacrosaurus_stebingeri),Hypacrosaurus_altispinus),Parasaurolophus),Olorotitan),Tsintaosaurus)),Bactrosaurus),Tethyshadros),Probactrosaurus),(Mantellisaurus,Iguanodon)),Ouranosaurus),Uteodon),Camptosaurus),(Dryosaurus,Dysalotosaurus)),Tenontosaurus),Zalmoxes),Parksosaurus),(Gasparinisaura,Talenkauen)),Thescelosaurus),Hypsilophodon),((((Montanoceratops,Leptoceratops),Protoceratops),(Psittacosaurus_neimongoliensis,Psittacosaurus_mongoliensis)),(Pachycephalosaurus,Prenocephale))),Othnielosaurus),Agilisaurus),Heterodontosaurus)))),Marasuchus);")
# Drawing phylogeny with no specified branch lengths:
phylogeny = collapse.singles(raw_phylogeny)
plot.phylo(phylogeny, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin=T) # These settings are good for displaying this phylogeny - uncluttered text and clear branches.
# Loading data for the taxa of interest:
data = read.table("occurrence__data.txt", sep = "\t", header = T)
time_data = read.table("time_data.txt", row.names = 1, sep="\t", header = T)
#Storing important variables
taxa = data$TAXON
trochanter_position = data$FTP
body_mass = data$MASS
FAD = data$FAD
LAD = data$LAD
# Function calculates branch lengths for the phylogeny, drawing on geologic occurrence data and randomized values for birth, extinction, and sampling rate. It can do this any number of times, and store each run's data as a separate column in a matrix of 134 rows (the number of edges on the tree)
tree_scaler = function(tree, occurrence, repetitions) {
all_Lengths = matrix(, nrow = 134, ncol = repetitions)
for (i in 1:repetitions) {
birthRate = runif(1, min = 0.001, max = 0.15)
extRate = runif(1, min = 0.001, max = 0.15)
samplRate = runif(1, min = 0.146, max = 0.262)
scaledTree = cal3TimePaleoPhy(tree = tree, timeData = occurrence, sampRate = samplRate, brRate = birthRate, extRate = extRate, dateTreatment = "minMax", ntrees = 1)
branchLength = scaledTree$edge.length
all_Lengths[,i] = branchLength
}
assign("all_Lengths", all_Lengths,.GlobalEnv)
return(all_Lengths)
}
#Running tree_scaler 100 times
tree_scaler(phylogeny, time_data, 100)
avg_Lengths = rowMeans(all_Lengths, na.rm=FALSE, dims=1) #Takes mean of each row to obtain "average" branch lengths for the phylogeny
#Plotting "average" tree
avg_Tree = cal3TimePaleoPhy(tree = phylogeny, timeData = time_data, sampRate = runif(1, min = 0.146, max = 0.262), brRate = runif(1, min = 0.001, max = 0.15), extRate = runif(1, min = 0.001, max = 0.15), dateTreatment = "minMax", ntrees = 1)
avg_Tree$edge.length = avg_Lengths
plot(avg_Tree, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin = T)
Contrast_bodyMass = pic(body_mass, avg_Tree)
Contrast_Trochanter = pic(trochanter_position, avg_Tree)
phylosignal(trochanter_position, avg_Tree)
rm(list=ls()) #Clears pre-existing variables
# Loading required packages for session:
library(ape)
library(picante)
library(paleotree)
library(phytools)
library(ggplot2)
# Reading phylogeny of taxa of interest:
raw_phylogeny = read.newick(text = "(((((((((((((((Tyrannosaurus,Tarbosaurus),Daspletosaurus),(Gorgosaurus,Albertosaurus)),Bistahieversor),(Compsognathus,Sinosauropteryx)),(((Giganotosaurus,Acrocanthosaurus),Allosaurus),(Sinraptor,Yangchuanosaurus))),((Suchomimus,Streptospondylus),Piatnitzkysaurus)),Sinosaurus),Ceratosaurus),Dilophosaurus),Liliensternus),(Herrarasaurus,Staurikosaurus)),Eoraptor),(((((((((((((((((((((((((Saurolophus_osborni,Saurolophus_angustirostris),Gryposaurus),(Edmontosaurus_regalis,Edmontosaurus_annectens)),Shantungosaurus),(Brachylophosaurus,Maiasaura)),(((((((Lambeosaurus_lambei,Lambeosaurus_magnicristatus),(Corythosaurus_casuarius,Corythosaurus_intermedius)),Hypacrosaurus_stebingeri),Hypacrosaurus_altispinus),Parasaurolophus),Olorotitan),Tsintaosaurus)),Bactrosaurus),Tethyshadros),Probactrosaurus),(Mantellisaurus,Iguanodon)),Ouranosaurus),Uteodon),Camptosaurus),(Dryosaurus,Dysalotosaurus)),Tenontosaurus),Zalmoxes),Parksosaurus),(Gasparinisaura,Talenkauen)),Thescelosaurus),Hypsilophodon),((((Montanoceratops,Leptoceratops),Protoceratops),(Psittacosaurus_neimongoliensis,Psittacosaurus_mongoliensis)),(Pachycephalosaurus,Prenocephale))),Othnielosaurus),Agilisaurus),Heterodontosaurus)))),Marasuchus);")
# Drawing phylogeny with no specified branch lengths:
phylogeny = collapse.singles(raw_phylogeny)
plot.phylo(phylogeny, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin=T) # These settings are good for displaying this phylogeny - uncluttered text and clear branches.
# Loading data for the taxa of interest:
data = read.table("occurrence__data.txt", sep = "\t", header = T)
time_data = read.table("time_data.txt", row.names = 1, sep="\t", header = T)
#Storing important variables
taxa = data$TAXON
trochanter_position = data$FTP
body_mass = data$MASS
FAD = data$FAD
LAD = data$LAD
# Function calculates branch lengths for the phylogeny, drawing on geologic occurrence data and randomized values for birth, extinction, and sampling rate. It can do this any number of times, and store each run's data as a separate column in a matrix of 134 rows (the number of edges on the tree)
tree_scaler = function(tree, occurrence, repetitions) {
all_Lengths = matrix(, nrow = 134, ncol = repetitions)
for (i in 1:repetitions) {
birthRate = runif(1, min = 0.001, max = 0.15)
extRate = runif(1, min = 0.001, max = 0.15)
samplRate = runif(1, min = 0.146, max = 0.262)
scaledTree = cal3TimePaleoPhy(tree = tree, timeData = occurrence, sampRate = samplRate, brRate = birthRate, extRate = extRate, dateTreatment = "minMax", ntrees = 1)
branchLength = scaledTree$edge.length
all_Lengths[,i] = branchLength
}
assign("all_Lengths", all_Lengths,.GlobalEnv)
return(all_Lengths)
}
#Running tree_scaler 100 times
tree_scaler(phylogeny, time_data, 100)
avg_Lengths = rowMeans(all_Lengths, na.rm=FALSE, dims=1) #Takes mean of each row to obtain "average" branch lengths for the phylogeny
#Plotting "average" tree
avg_Tree = cal3TimePaleoPhy(tree = phylogeny, timeData = time_data, sampRate = runif(1, min = 0.146, max = 0.262), brRate = runif(1, min = 0.001, max = 0.15), extRate = runif(1, min = 0.001, max = 0.15), dateTreatment = "minMax", ntrees = 1)
avg_Tree$edge.length = avg_Lengths
plot(avg_Tree, edge.width = 2, font = 4, cex = 0.53, label.offset = 0.5, no.margin = T)
#Testing for Phylogenetic Signal
phylosignal(trochanter_position, avg_Tree)
phylosignal(body_mass, avg_Tree)
## K for 4th trochanter position is 1.267668, indicating that related species resemble each other more than would be expected under a random walk through morphospace. In contrast, K for body mass is 0.3015823, indicating that closely related species resemble each other less than would be expected by chance. The p-values for both are less than 0.05, suggesting that the phylogenetic signal is non random - that is, that the results reflect something biologically "real".
## Simulating character data
ntips = length(avg_Tree$tip.label)
x = rnorm(ntips, mean=0, sd=1)
phylosignal(x, avg_Tree)
## Yields K = 0.1121477 and p-value of 0.545.
#Testing for Correlation with Body Mass
#Simple Regression
regressPosition = lm(trochanter_position~log10(body_mass))
summary.lm(regressPosition)
## Correlation significant (p = 0.0482)
#Independant Contrasts
Contrast_bodyMass = pic(body_mass, avg_Tree)
Contrast_Trochanter = pic(trochanter_position, avg_Tree)
regressContrastPosition = lm(Contrast_Trochanter-1~Contrast_bodyMass)
summary.lm(regressContrastPosition)
## Correlation significant (p = 0.0381)
#Regressions by Order
Saurischia = data.frame(body_mass[1:23], trochanter_position[1:23])
names(Saurischia) = c("body_mass", "trochanter_position")
Ornithischia = data.frame(body_mass[24:67], trochanter_position[24:67])
names(Ornithischia) = c("body_mass", "trochanter_position")
Marasuchus = data.frame(body_mass[68], trochanter_position[68])
names(Marasuchus) = c("body_mass", "trochanter_position")
regressSaurischia = lm(Saurischia$trochanter_position~log10(Saurischia$body_mass))
summary.lm(regressSaurischia)
## Correlation significant (0.004157)
regressOrnithischia = lm(Ornithischia$trochanter_position~log10(Ornithischia$body_mass))
summary.lm(regressOrnithischia)
## Correlation insignificant (0.0673)
#Plotting
plot(log10(body_mass), trochanter_position, type = "n", main = "Figure 3", xlab = "Log10 Body Mass (kg)", ylab = "4th Trochanter Position (% downshaft)")
points(log10(body_mass[1:23]), trochanter_position[1:23], pch = 17, cex = 1.2, col="red")
points(log10(body_mass[24:67]), trochanter_position[24:67], pch = 19, cex = 1.1, col="forest green")
points(log10(body_mass[68]), trochanter_position[68], pch = "*", cex = 2, col="cadetblue")
abline(regressPosition$coefficients, lwd = 2, lty = 5)
abline(regressSaurischia$coefficients, lwd = 2, col = "red", lty = 3)
abline(regressOrnithischia$coefficients, lwd = 2, col = "forest green", lty = 3)
legend(0.27, 0.63, legend = c("Saurischia", "Ornithischia"), col=c("red", "forest green"), lty = 3)
plot(Contrast_bodyMass, Contrast_Trochanter, main = "Figure 4", xlab = "Body Mass Contrast", ylab = "4th Trochanter Position Contrast")
regressContrastPosition$coefficients
plot(log10(body_mass), trochanter_position, type = "n", main = "Figure 3", xlab = "Log10 Body Mass (kg)", ylab = "4th Trochanter Position (% downshaft)")
points(log10(body_mass[1:23]), trochanter_position[1:23], pch = 17, cex = 1.2, col="red")
points(log10(body_mass[24:67]), trochanter_position[24:67], pch = 19, cex = 1.1, col="forest green")
points(log10(body_mass[68]), trochanter_position[68], pch = "*", cex = 2, col="cadetblue")
abline(regressPosition$coefficients, lwd = 2, lty = 5)
abline(regressSaurischia$coefficients, lwd = 2, col = "red", lty = 3)
abline(regressOrnithischia$coefficients, lwd = 2, col = "forest green", lty = 3)
legend(0.27, 0.63, legend = c("Saurischia", "Ornithischia"), col=c("red", "forest green"), lty = 3)
