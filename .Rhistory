tiplabels(tip = which(prunedcomm$tip.label %in% names(which(comm [i, ] > 0)))}
for (i in row.names(comm)) {
plot(prunedcomm, show.tip.label = FALSE, main = i)
tiplabels(tip = which(prunedcomm$tip.label %in% names(which(comm [i, ] > 0))))}
psd(prunecomm,ultramphipod)
prunecomm = prune.sample(comm,ultramphipod)
prunecomm = comm[,which(colnames(comm) %in% ultramphipod$tip.label)]
even = rep(0.5,ncol(prunecomm))
random = runif(ncol(prunecomm), 0,1)
prunecomm = rbind(rbind(prunecomm, even), random)
mntd(prunecomm, amphi_dist)
View(amphi_dist)
amphi_dist
mntd(prunecomm, cophenetic(ultramphipod))
mpd(prunecomm, cophenetic(ultramphipod))
plot(hclust(Comdist))
ses.mntd(prunecomm, cophenetic(ultramphipod))
ses.mpd(prunecomm, cophenetic(ultramphipod))
psc(prunecomm, cophenetic(ultramphipod))
PSClustering = psc(prunecomm, cophenetic(ultramphipod))
View(PSClustering)
mean(PSClustering$PSCs)
mean(PSClustering$PSCs[which(!is.na(PSClustering$PSCs))])
phylostruct(prunecomm, cophenetic(ultramphipod))
cophy
cophy$assoc
cophy
cophy$trees
cophy$trees[1]
cophy$trees[3]
plot(cophy)
Bk_plot(ultramphipod, ultram)
phangorn::treedist(ultramphipod, ultram)
parafit(cophenetic(ultram),cophenetic(ultramphipod), comm)
parafit(cophenetic(ultram),cophenetic(ultramphipod), t(comm))
parafit(cophenetic(ultram),cophenetic(ultramphipod), comm)
parafit(as.matrix(cophenetic(ultram)),as.matrix(cophenetic(ultramphipod)), comm)
as.matrix(cophenetic(ultram))
data(gopher.D)
data(lice.D)
data(HP.links)
View(gopher.D)
View(HP.links)
dim(HP.links)
dim(lice.D)
dim(gopher.D)
dim(comm)
dim(ultram)
dim(as.matrix(cophenetic(ultram)))
dim(as.matrix(cophenetic(ultramphipod)))
parafit(as.matrix(cophenetic(ultram)),as.matrix(cophenetic(ultramphipod)), comm[which(rownames(comm) %in% ultram$tip.label),])
comm[which(rownames(comm) %in% ultram$tip.label),]
dim(comm[which(rownames(comm) %in% ultram$tip.label),])
parafit(as.matrix(cophenetic(ultram)),as.matrix(cophenetic(ultramphipod)), comm[which(rownames(comm) %in% ultram$tip.label),which(colnames(comm) %in% ultramphipo$tip.label)])
parafit(as.matrix(cophenetic(ultram)),as.matrix(cophenetic(ultramphipod)), comm[which(rownames(comm) %in% ultram$tip.label),which(colnames(comm) %in% ultramphipod$tip.label)])
Parafit = parafit(as.matrix(cophenetic(ultram)),as.matrix(cophenetic(ultramphipod)), comm[which(rownames(comm) %in% ultram$tip.label),which(colnames(comm) %in% ultramphipod$tip.label)])
Parafit$p.global
Parafit$para.per.host
Parafit$host.per.para
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="cladogram", space=200, gap=0,show.tip.label=F, use.edge.length=F)
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="cladogram", space=200, gap=0,show.tip.label=T, use.edge.length=F)
par(mfrow=c(1,1))
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="cladogram", space=300, gap=0,show.tip.label=T, use.edge.length=F)
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="cladogram", space=100, gap=100,show.tip.label=T, use.edge.length=F)
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="cladogram", space=100, gap=10,show.tip.label=T, use.edge.length=F)
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="cladogram", space=100, gap=0,show.tip.label=T, use.edge.length=F)
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="cladogram", space=50, gap=0,show.tip.label=T, use.edge.length=F)
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="cladogram", space=80, gap=0,show.tip.label=T, use.edge.length=F)
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="cladogram", space=20, gap=0,show.tip.label=T, use.edge.length=F)
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="cladogram", space=200, gap=0,show.tip.label=T, use.edge.length=F)
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="cladogram", space=100, gap=0,show.tip.label=T, use.edge.length=F)
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="cladogram", space=90, gap=0,show.tip.label=T, use.edge.length=F)
install.packages("paco")
library(paco)
D = prepare_paco_data(cophenetic(ultram), cophenetic(ultramphipod), comm[which(rownames(comm) %in% ultram$tip.label),which(colnames(comm) %in% ultramphipod$tip.label)])
D = add_pcoord(D)
D = PACo(D, nperm=10, seed=42, method="r0", correction='cailliez')
print(D$gof)
D
View(comm)
ultram
ultram$edge
ultram$Nnode
ultram$Ntip
Ntip(ultram)
ultram$tip.label
amphipods
amphipodML = read.tree("Amphipods/Interesting\ amphipods/RAxML/RAxML_bipartitions.datamphipods18S_ML_boot100")
setwd("~/Documents/0BIOL_Phylogenetics/phylobio_final_project")
amphipodML = read.tree("Amphipods/Interesting\ amphipods/RAxML/RAxML_bipartitions.datamphipods18S_ML_boot100")
amphipodML = read.tree("Amphipods/Interesting\ amphipods/RAxML/RAxML_bipartitions.datamphipod18S_ML_boot100")
plot(amphipodML)
which(amphipodML$tip.label == "Phronima_species")
amphipodML$tip.label[which(amphipodML$tip.label == "Phronima_species")] = "Phronima_sedentaria"
plot(amphipodML)
nodelabels()
amphipodML=reroot(amphipodML, 33)
plot(amphipodML)
amphipodML=ape::reroot(amphipodML, 33)
amphipodML=phytools::reroot(amphipodML, 33)
is.rooted(amphipodML)
amphipodML=ggtree::reroot(amphipodML, 33)
amphipodML=root(amphipodML, 33)
amphipodML
length(amphipodML$tip.label)
plot(amphipodML)
nodelabels()
ultram
amphipodB = read.tree("Amphipods/Interesting\ amphipods/output/datamphipod18S_MSA_bayesian_run_1.tree")
amphipodB = read.nexus("Amphipods/Interesting\ amphipods/output/datamphipod18S_MSA_bayesian_run_1.tree")
plot(amphipodB)
amphipodB$tip.label[which(amphipodB$tip.label == "Phronima_species")] = "Phronima_sedentaria"
nodelabels()
amphipodML=root(amphipodML, 47)
plot(amphipodML)
amphipodML=reroot(amphipodML, 47)
plot(amphipodML)
amphipodB = read.nexus("Amphipods/Interesting\ amphipods/output/datamphipod18S_MSA_bayesian_run_1.tree")
plot(amphipodB)
amphipodB$tip.label[which(amphipodB$tip.label == "Phronima_species")] = "Phronima_sedentaria"
nodelabels()
amphipodML=reroot(amphipodML, 47)
plot(amphipodML)
amphipodB
nodelabels()
amphipodML=reroot(amphipodML, 52)
plot(amphipodML)
amphipodB = read.nexus("Amphipods/Interesting\ amphipods/output/datamphipod18S_MSA_bayesian_run_1.tree")
plot(amphipodB)
amphipodB$tip.label[which(amphipodB$tip.label == "Phronima_species")] = "Phronima_sedentaria"
nodelabels()
amphipodB=reroot(amphipodB, 47)
plot(amphipodB)
amphipodB$tip.label = str_replace_all(amphipodB$tip.label,'_',' ')
plot(amphipodB)
treespp2013 = amphipodML$tip.label
prunedmatrix = assmatrix[which(assmatrix$amphipod %in% treespp2013),]
prunedass = as.matrix(ass[which(ass$amphipod %in% treespp2013),])
prunedass[,2] = as.matrix(str_replace_all(prunedass[,2],'conica','sp.'))
heatmap(as.matrix(prunedmatrix[,2:94]), col=c("white", "orange"), Rowv=NA, Colv=NA)
View(prunedmatrix)
assmatrix$amphipod
treespp2013
treespp2013 = amphipodB$tip.label
prunedmatrix = assmatrix[which(assmatrix$amphipod %in% treespp2013),]
prunedass = as.matrix(ass[which(ass$amphipod %in% treespp2013),])
prunedass[,2] = as.matrix(str_replace_all(prunedass[,2],'conica','sp.'))
heatmap(as.matrix(prunedmatrix[,2:94]), col=c("white", "orange"), Rowv=NA, Colv=NA)
sharedspp = as.vector(prunedass[,2][which(prunedass[,2] %in% TREE$tip.label)])
nodatatipnames = TREE$tip.label[which(!(TREE$tip.label %in% sharedspp))]
nodatatips = c(1:length(TREE$tip.label))[which(TREE$tip.label %in% nodatatipnames)]
prunedtree = drop.tip(TREE, nodatatips)
prunedtree$tip.label
plot(prunedtree)
ultram = chronos(prunedtree)
plot(ultram)
reprunedass = as.matrix(prunedass[which(prunedass[,2] %in% ultram$tip.label),])
reprunedass = reprunedass[match(ultram$tip.label, reprunedass[,2]),]
reprunedassmatrix = as.matrix(dcast(as.data.frame(reprunedass), amphipod~host, length))
reprunedassmatrix = reprunedassmatrix[,2:16]
class(reprunedassmatrix) <- "numeric"
rownames(reprunedassmatrix) = dcast(as.data.frame(reprunedass), amphipod~host, length)[,1]
heatmap(reprunedassmatrix[,2:9], col=c("white", "orange"), Rowv=NA, Colv=NA)
amphipodB = drop.tip(amphipodB, which(!(amphipodML$tip.label %in% rownames(reprunedassmatrix))))
ultramphipod = chronos(amphipodB)
plot(ultramphipod)
plot(ultram)
setwd("~/Documents/0BIOL_Phylogenetics/phylobio_final_project")
ass = unique(read.table("Associations.csv", sep = '\t', header = T)[,c(1,2)])
amphipods = sort(as.vector(unique(ass$amphipod)))
hosts = sort(as.vector(unique(ass$host)))
setwd("~/Documents/0BIOL_Phylogenetics/phylobio_final_project")
ass = unique(read.table("Associations.csv", sep = '\t', header = T)[,c(1,2)])
amphipods = sort(as.vector(unique(ass$amphipod)))
hosts = sort(as.vector(unique(ass$host)))
library(stringr)
library(ape)
library(phytools)
library(ggtree)
library(reshape2)
library(igraph)
library(network)
library(dendextend)
library(picante)
library(paco)
assmatrix = dcast(ass, amphipod~host, length)
rownames(assmatrix) = assmatrix[,1]
heatmap(as.matrix(assmatrix[,2:94]), col=c("white", "orange"), Rowv=NA, Colv=NA)
amphipodB = read.nexus("Amphipods/Interesting\ amphipods/output/datamphipod18S_MSA_bayesian_run_1.tree")
plot(amphipodB)
amphipodB$tip.label[which(amphipodB$tip.label == "Phronima_species")] = "Phronima_sedentaria"
nodelabels()
amphipodB=reroot(amphipodB, 46)
plot(amphipodB)
amphipodB = read.nexus("Amphipods/Interesting\ amphipods/output/datamphipod18S_MSA_bayesian_run_1.tree")
plot(amphipodB)
amphipodB$tip.label[which(amphipodB$tip.label == "Phronima_species")] = "Phronima_sedentaria"
nodelabels()
amphipodB = read.nexus("Amphipods/Interesting\ amphipods/output/datamphipod18S_MSA_bayesian_run_1.tree")
plot(amphipodB)
amphipodB$tip.label[which(amphipodB$tip.label == "Phronima_species")] = "Phronima_sedentaria"
nodelabels()
amphipodB=reroot(amphipodB, 47)
plot(amphipodB)
View(assmatrix)
amphipodB = read.nexus("Amphipods/Interesting\ amphipods/output/datamphipod18S_MSA_bayesian_run_1.tree")
plot(amphipodB)
amphipodB$tip.label[which(amphipodB$tip.label == "Phronima_species")] = "Phronima_sedentaria"
amphipodB$tip.label[which(amphipodB$tip.label == "Paraphronima_species")] = "Paraphronima_gracilis"
nodelabels()
amphipodB=reroot(amphipodB, 47)
plot(amphipodB)
refhostree = read.nexus("FirstHostRound/output/host18S_bayesian2_run_1.tree")
refhostree$tip.label
MLext = read.tree("ExtendedHosts/RAxML/RAxML_bipartitions.EXThostML_boot100")
badtips = which(!(MLext$tip.label %in% refhostree$tip.label))
hostML = drop.tip(MLext, badtips)
plot(hostML)
nodelabels()
hostML = reroot(hostML, 85)
plot(hostML)
TREE = hostML
TREE$tip.label = str_replace_all(TREE$tip.label,'_',' ')
#amphipodML$tip.label = str_replace_all(amphipodML$tip.label,'_',' ')
amphipodB$tip.label = str_replace_all(amphipodB$tip.label,'_',' ')
TREE$tip.label
amphipodB$tip.label
amphispp = amphipodB$tip.label
prunedmatrix = assmatrix[which(assmatrix$amphipod %in% amphispp),]
prunedass = as.matrix(ass[which(ass$amphipod %in% amphispp),])
prunedass[,2] = as.matrix(str_replace_all(prunedass[,2],'conica','sp.'))
heatmap(as.matrix(prunedmatrix[,2:94]), col=c("white", "orange"), Rowv=NA, Colv=NA)
sharedspp = as.vector(prunedass[,2][which(prunedass[,2] %in% TREE$tip.label)])
sharedspp
nodatatipnames = TREE$tip.label[which(!(TREE$tip.label %in% sharedspp))]
nodatatips = c(1:length(TREE$tip.label))[which(TREE$tip.label %in% nodatatipnames)]
prunedtree = drop.tip(TREE, nodatatips)
prunedtree$tip.label
plot(prunedtree)
ultram = chronos(prunedtree)
plot(ultram)
View(prunedass)
reprunedass = as.matrix(prunedass[which(prunedass[,2] %in% ultram$tip.label),])
reprunedass = reprunedass[match(ultram$tip.label, reprunedass[,2]),]
View(reprunedass)
reprunedassmatrix = as.matrix(dcast(as.data.frame(reprunedass), amphipod~host, length))
View(reprunedassmatrix)
reprunedassmatrix = reprunedassmatrix[,2:ncol(reprunedassmatrix)]
class(reprunedassmatrix) <- "numeric"
rownames(reprunedassmatrix) = dcast(as.data.frame(reprunedass), amphipod~host, length)[,1]
heatmap(reprunedassmatrix[,2:9], col=c("white", "orange"), Rowv=NA, Colv=NA)
heatmap(reprunedassmatrix[,2:], col=c("white", "orange"), Rowv=NA, Colv=NA)
heatmap(reprunedassmatrix[,2:ncol(reprunedassmatrix)], col=c("white", "orange"), Rowv=NA, Colv=NA)
prunedamphipodB = drop.tip(amphipodB, which(!(amphipodML$tip.label %in% rownames(reprunedassmatrix))))
prunedamphipodB = drop.tip(amphipodB, which(!(amphipodB$tip.label %in% rownames(reprunedassmatrix))))
ultramphipod = chronos(prunedamphipodB)
plot(ultramphipod)
g <- graph_from_edgelist(as.matrix(ass))
#g <- graph_from_edgelist(prunedass)
g <- graph_from_edgelist(as.matrix(reprunedass))
V(g)$color <- ifelse(V(g)$name %in% hosts, "lightblue", "red")
V(g)$label.color <- ifelse(V(g)$name %in% hosts, "blue", "darkred")
V(g)$types <- ifelse(V(g)$name %in% hosts, F, T)
Lo = layout_as_bipartite(g, types = V(g)$types, hgap = 15, vgap = 600)
Lc = layout_in_circle(g, order = c(V(g)[which(V(g)$name %in% amphipods)], V(g)[which(V(g)$name %in% hosts)]))
c= tkplot(g, canvas.width = 700, canvas.height = 700, vertex.size = 2.8, layout=Lc, vertex.label.dist = 0.3, vertex.label.cex = 0.5)
tkplot.fit.to.screen(c, height = 500, width = 500)
tkplot.center(c)
ggtree(ultram, layout="circular") + geom_tiplab(aes(angle=angle), color='blue')
labeled = ultram
labeled$edge.length = labeled$edge.length * 10
dd = data.frame(taxa  = labeled$tip.label, amphipod = reprunedass[,1])
p = ggtree(labeled, layout="rectangular") + xlim(NA, 23)
p = p %<+% dd + geom_tiplab(aes(color=amphipod), show_guide = FALSE, size = 3.5) + geom_tippoint(aes(color=amphipod), alpha=0.25)
p+theme(legend.position="right") + guides(color=guide_legend(title="Amphipod", reverse=T))
map = t(reprunedassmatrix)
#class(map) <- "string"
yx = ggtree(labeled) + geom_tiplab(color='black', size = 3) + geom_treescale(x=2008, y=1)
gheatmap(yx, map[,3:5], low="white", high="black", offset = 2, width=0.5)
yx
View(prunedmatrix)
prunedmatrix_nosppcol = prunedmatrix[,-1]
comm = t(prunedmatrix_nosppcol)
comm = comm[rowSums(comm)!=0,]
heatmap(as.matrix(comm), Rowv=NA, Colv=NA, col = c("white","grey"))
amphi_dist=species.dist(comm)
heatmap(as.matrix(amphi_dist), Rowv=NA, Colv=NA, col=rev(heat.colors(5)))
plot(hclust(amphi_dist))
AD_MDS = cmdscale(amphi_dist)
par(mar=rep(4,4))
plot(AD_MDS[,1], AD_MDS[,2])
text(AD_MDS[,1], AD_MDS[,2], labels = row.names(AD_MDS), cex=.7)
Comdist = comdist(comm,amphi_dist)
heatmap(as.matrix(Comdist), Rowv=NA, Colv=NA, col=rev(heat.colors(20)))
par(mar=rep(1,4))
plot(hclust(Comdist))
C_MDS = cmdscale(Comdist)
plot(C_MDS[,1], C_MDS[,2], xlim = c(-0.25,0.2))
text(C_MDS[,1], C_MDS[,2], labels = row.names(C_MDS), cex=0.5, pos = 1)
CPC = comm.phylo.cor(comm,ultramphipod)
MPC = match.phylo.comm(ultramphipod, comm)
ultram = drop.tip(ultram, which(!(ultram$tip.label %in% rownames(comm))))
plot(ultram)
phyloDiversity = pd(comm,ultramphipod)
plot(ultramphipod)
prunecomm = prune.sample(comm,ultramphipod)
prunecomm = comm[,which(colnames(comm) %in% ultramphipod$tip.label)]
even = rep(0.5,ncol(prunecomm))
random = runif(ncol(prunecomm), 0,1)
prunecomm = rbind(rbind(prunecomm, even), random)
mntd(prunecomm, cophenetic(ultramphipod))
mpd(prunecomm, cophenetic(ultramphipod))
ses.mntd(prunecomm, cophenetic(ultramphipod))
ses.mpd(prunecomm, cophenetic(ultramphipod))
PSClustering = psc(prunecomm, cophenetic(ultramphipod))
mean(PSClustering$PSCs[which(!is.na(PSClustering$PSCs))])
phylostruct(prunecomm, cophenetic(ultramphipod))
reprunedass = as.data.frame(reprunedass)
rownames(reprunedass) = 1:nrow(reprunedass)
par(mfrow=c(1,1))
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="cladogram", space=90, gap=0,show.tip.label=T, use.edge.length=F)
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="cladogram", space=100, gap=0,show.tip.label=T, use.edge.length=F)
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="cladogram", space=120, gap=0,show.tip.label=T, use.edge.length=F)
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="phylogram", space=120, gap=0,show.tip.label=T, use.edge.length=F)
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="phylogram", space=150, gap=0,show.tip.label=T, use.edge.length=F)
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="phylogram", space=110, gap=0,show.tip.label=T, use.edge.length=F)
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="phylogram", space=110, gap=10,show.tip.label=T, use.edge.length=F)
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="phylogram", space=110, gap=0,show.tip.label=T, use.edge.length=F)
cophy = cophylo(ultramphipod, ultram, assoc = reprunedass, rotate = F)
plot(cophy)
Parafit = parafit(as.matrix(cophenetic(ultram)),as.matrix(cophenetic(ultramphipod)), comm[which(rownames(comm) %in% ultram$tip.label),which(colnames(comm) %in% ultramphipod$tip.label)])
D = prepare_paco_data(cophenetic(ultram), cophenetic(ultramphipod), comm[which(rownames(comm) %in% ultram$tip.label),which(colnames(comm) %in% ultramphipod$tip.label)])
D = add_pcoord(D)
D = PACo(D, nperm=10, seed=42, method="r0", correction='cailliez')
print(D$gof)
D
print(D$H_PCo)
plot(D$H_PCo)
biplot(D$H_PCo)
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="phylogram", space=110, gap=0,show.tip.label=T, use.edge.length=F, col="orange")
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="phylogram", space=110, gap=0,show.tip.label=F, use.edge.length=F, col="orange")
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="phylogram", space=60, gap=0,show.tip.label=F, use.edge.length=F, col="orange")
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="phylogram", space=300, gap=0,show.tip.label=F, use.edge.length=F, col="orange")
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="phylogram", space=200, gap=0,show.tip.label=F, use.edge.length=F, col="orange")
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="phylogram", space=100, gap=0,show.tip.label=F, use.edge.length=F, col="orange")
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="phylogram", space=100, gap=30,show.tip.label=F, use.edge.length=F, col="orange")
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="phylogram", space=100, gap=0,show.tip.label=F, use.edge.length=F, col="orange")
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="phylogram", space=110, gap=0,show.tip.label=T, use.edge.length=F, col="orange")
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="phylogram", space=110, gap=0,show.tip.label=T, use.edge.length=T, col="orange")
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="phylogram", space=110, gap=0,show.tip.label=T, use.edge.length=F, col="orange")
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="phylogram", space=110, gap=0,show.tip.label=T, use.edge.length=F, col="orange", rotate=T)
cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="phylogram", space=110, gap=0,show.tip.label=T, use.edge.length=F, col="orange")
as.network(cophy)
as.network(cophyloplot(ultramphipod, ultram, assoc = reprunedass, type="phylogram", space=110, gap=0,show.tip.label=T, use.edge.length=F, col="orange"))
heatmap(reprunedassmatrix[,2:ncol(reprunedassmatrix)], col=c("white", "orange"), Rowv=NA, Colv=NA)
heatmap(as.matrix(prunedmatrix[,2:94]), col=c("white", "orange"), Rowv=NA, Colv=NA)
heatmap(reprunedassmatrix[,2:ncol(reprunedassmatrix)], col=c("white", "orange"), Rowv=NA, Colv=NA)
heatmap(as.matrix(Comdist), Rowv=NA, Colv=NA, col=rev(heat.colors(20)))
heatmap(as.matrix(amphi_dist), Rowv=NA, Colv=NA, col=rev(heat.colors(5)))
par(mar=rep(4,4))
heatmap(as.matrix(comm), Rowv=NA, Colv=NA, col = c("white","grey"))
par(mar=rep(5,4))
heatmap(as.matrix(comm), Rowv=NA, Colv=NA, col = c("white","grey"))
labeled = ultramphipod
labeled$edge.length = labeled$edge.length * 10
labeled = ultramphipod
labeled$edge.length = labeled$edge.length * 10
dd = data.frame(taxa  = labeled$tip.label, hosts = reprunedass[,2])
p = ggtree(labeled, layout="rectangular") + xlim(NA, 23)
p = p %<+% dd + geom_tiplab(aes(color=hosts), show_guide = FALSE, size = 3.5) + geom_tippoint(aes(color=hosts), alpha=0.25)
p+theme(legend.position="right") + guides(color=guide_legend(title="Gelatinous host", reverse=T))
reprunedass[,2]
labeled = ultramphipod
labeled$edge.length = labeled$edge.length * 10
dd = data.frame(taxa  = labeled$tip.label, hosts = as.vector(reprunedass[,2]))
p = ggtree(labeled, layout="rectangular") + xlim(NA, 23)
p = p %<+% dd + geom_tiplab(aes(color=hosts), show_guide = FALSE, size = 3.5) + geom_tippoint(aes(color=hosts), alpha=0.25)
p+theme(legend.position="right") + guides(color=guide_legend(title="Gelatinous host", reverse=T))
ultramphipod
dim(reprunedass)
amphipodB
labeled = ultramphipod
labeled$edge.length = labeled$edge.length * 10
dd = data.frame(taxa  = labeled$tip.label, hosts = as.vector(prunedass[,2]))
p = ggtree(labeled, layout="rectangular") + xlim(NA, 23)
p = p %<+% dd + geom_tiplab(aes(color=hosts), show_guide = FALSE, size = 3.5) + geom_tippoint(aes(color=hosts), alpha=0.25)
p+theme(legend.position="right") + guides(color=guide_legend(title="Gelatinous host", reverse=T))
dim(prunedass)
dim(ass)
dim(reprunedass)
labeled = ultram
labeled$edge.length = labeled$edge.length * 10
dd = data.frame(taxa  = labeled$tip.label, amphipod = reprunedass[,1])
p = ggtree(labeled, layout="rectangular") + xlim(NA, 23)
p = p %<+% dd + geom_tiplab(aes(color=amphipod), show_guide = FALSE, size = 3.5) + geom_tippoint(aes(color=amphipod), alpha=0.25)
p+theme(legend.position="right") + guides(color=guide_legend(title="Amphipod", reverse=T))
ultram
ultramphipod
dim(reprunedass)
labeled = ultramphipod
labeled$edge.length = labeled$edge.length * 10
dd = data.frame(taxa  = labeled$tip.label, hosts = as.vector(reprunedass[,2]))
labeled$tip.label
ddat = as.vector(reprunedass[which(reprunedass$amphipod %in% labeled$tip.label),2])
ddat
labeled = ultramphipod
labeled$edge.length = labeled$edge.length * 10
ddat = as.vector(reprunedass[which(reprunedass$amphipod %in% labeled$tip.label),2])
dd = data.frame(taxa  = labeled$tip.label, hosts = ddat)
p = ggtree(labeled, layout="rectangular") + xlim(NA, 23)
p = p %<+% dd + geom_tiplab(aes(color=hosts), show_guide = FALSE, size = 3.5) + geom_tippoint(aes(color=hosts), alpha=0.25)
p+theme(legend.position="right") + guides(color=guide_legend(title="Gelatinous host", reverse=T))
labeled = ultram
labeled$edge.length = labeled$edge.length * 10
dd = data.frame(taxa  = labeled$tip.label, amphipod = reprunedass[,1])
p = ggtree(labeled, layout="rectangular") + xlim(NA, 23)
p = p %<+% dd + geom_tiplab(aes(color=amphipod), show_guide = FALSE, size = 3.5) + geom_tippoint(aes(color=amphipod), alpha=0.25)
p+theme(legend.position="right") + guides(color=guide_legend(title="Amphipod", reverse=T))
dd
dim(dd)
ddat = as.vector(unique(reprunedass)[,2])
dd = data.frame(taxa  = labeled$tip.label, hosts = ddat)
p = ggtree(labeled, layout="rectangular") + xlim(NA, 23)
p = p %<+% dd + geom_tiplab(aes(color=hosts), show_guide = FALSE, size = 3.5) + geom_tippoint(aes(color=hosts), alpha=0.25)
p+theme(legend.position="right") + guides(color=guide_legend(title="Gelatinous host", reverse=T))
labeled = ultramphipod
labeled$edge.length = labeled$edge.length * 10
ddat = as.vector(unique(reprunedass)[,2])
dd = data.frame(taxa  = labeled$tip.label, hosts = ddat)
p = ggtree(labeled, layout="rectangular") + xlim(NA, 23)
p = p %<+% dd + geom_tiplab(aes(color=hosts), show_guide = FALSE, size = 3.5) + geom_tippoint(aes(color=hosts), alpha=0.25)
p+theme(legend.position="right") + guides(color=guide_legend(title="Gelatinous host", reverse=T))
as.vector(unique(reprunedass)[,2])
ddat = as.vector(unique(reprunedass[,1])[,2])
ddat = reprunedass[which(reprunedass$amphipod %in% unique(reprunedass$amphipod)),2]
ddat
labeled = ultramphipod
labeled$edge.length = labeled$edge.length * 10
labeled
ddat = reprunedass[which(unique(reprunedass$amphipod) %in%  reprunedass$amphipod ),2]
ddat
labeled = ultramphipod
labeled$edge.length = labeled$edge.length * 10
dd = data.frame(taxa  = labeled$tip.label, hosts = reprunedass[17,2])
p = ggtree(labeled, layout="rectangular") + xlim(NA, 23)
p = p %<+% dd + geom_tiplab(aes(color=hosts), show_guide = FALSE, size = 3.5) + geom_tippoint(aes(color=hosts), alpha=0.25)
p+theme(legend.position="right") + guides(color=guide_legend(title="Gelatinous host", reverse=T))
labeled = ultramphipod
labeled$edge.length = labeled$edge.length * 10
dd = data.frame(taxa  = labeled$tip.label, hosts = as.vector(reprunedass[17,2]))
p = ggtree(labeled, layout="rectangular") + xlim(NA, 23)
p = p %<+% dd + geom_tiplab(aes(color=hosts), show_guide = FALSE, size = 3.5) + geom_tippoint(aes(color=hosts), alpha=0.25)
p+theme(legend.position="right") + guides(color=guide_legend(title="Gelatinous host", reverse=T))
dd
labeled = ultramphipod
labeled$edge.length = labeled$edge.length * 10
dd = data.frame(taxa  = labeled$tip.label, hosts = as.vector(reprunedass[1:17,2]))
p = ggtree(labeled, layout="rectangular") + xlim(NA, 23)
p = p %<+% dd + geom_tiplab(aes(color=hosts), show_guide = FALSE, size = 3.5) + geom_tippoint(aes(color=hosts), alpha=0.25)
p+theme(legend.position="right") + guides(color=guide_legend(title="Gelatinous host", reverse=T))
unique(reprunedass[,1])
View(unique(reprunedass[,1]))
View(as.vector(unique(reprunedass[,1])))
View(as.matrix(unique(reprunedass[,1])))
taxa = c("Scyphozoa","Hydromedusae","Hydromedusae","Hydromedusae","Siphonophorae", "Siphonophorae", "Siphonophorae", "Ctenophora", "Ctenophora", "Thaliacea", "Thaliacea", "Thaliacea", "Thaliacea", "Thaliacea", "Thaliacea", "Scyphozoa", "Radiolaria")
taxahostass = cbind(unique(reprunedass[,1]), taxa)
labeled = ultramphipod
labeled$edge.length = labeled$edge.length * 10
dd = data.frame(taxa  = labeled$tip.label, hosts = taxahostass)
p = ggtree(labeled, layout="rectangular") + xlim(NA, 23)
p = p %<+% dd + geom_tiplab(aes(color=hosts), show_guide = FALSE, size = 3.5) + geom_tippoint(aes(color=hosts), alpha=0.25)
p+theme(legend.position="right") + guides(color=guide_legend(title="Gelatinous host", reverse=T))
taxa
labeled
taxahostass = taxahostass[match(ultramphipod$tip.label, taxahostass[,1]),]
dd = data.frame(taxa  = labeled$tip.label, hosts = taxahostass)
p = ggtree(labeled, layout="rectangular") + xlim(NA, 23)
p = p %<+% dd + geom_tiplab(aes(color=hosts), show_guide = FALSE, size = 3.5) + geom_tippoint(aes(color=hosts), alpha=0.25)
p+theme(legend.position="right") + guides(color=guide_legend(title="Gelatinous host", reverse=T))
dd
taxahostass
taxahostass = cbind(unique(reprunedass[,1]), taxa)
taxahostass
unique(reprunedass[,1])
taxahostass = cbind(as.vector(unique(reprunedass[,1])), taxa)
taxahostass
taxahostass = taxahostass[match(ultramphipod$tip.label, taxahostass[,1]),]
taxahostass
labeled = ultramphipod
labeled$edge.length = labeled$edge.length * 10
dd = data.frame(taxa  = labeled$tip.label, hosts = taxahostass)
p = ggtree(labeled, layout="rectangular") + xlim(NA, 23)
p = p %<+% dd + geom_tiplab(aes(color=hosts), show_guide = FALSE, size = 3.5) + geom_tippoint(aes(color=hosts), alpha=0.25)
p+theme(legend.position="right") + guides(color=guide_legend(title="Gelatinous host", reverse=T))
dd
taxa = c("Scyphozoa","Hydromedusae","Hydromedusae","Hydromedusae","Siphonophorae", "Siphonophorae", "Siphonophorae", "Ctenophora", "Ctenophora", "Thaliacea", "Thaliacea", "Thaliacea", "Thaliacea", "Thaliacea", "Thaliacea", "Scyphozoa", "Radiolaria")
taxahostass = cbind(as.vector(unique(reprunedass[,1])), taxa)
taxahostass = taxahostass[match(ultramphipod$tip.label, taxahostass[,1]),]
labeled = ultramphipod
labeled$edge.length = labeled$edge.length * 10
dd = data.frame(taxa  = labeled$tip.label, hosts = taxahostass[,2])
p = ggtree(labeled, layout="rectangular") + xlim(NA, 23)
p = p %<+% dd + geom_tiplab(aes(color=hosts), show_guide = FALSE, size = 3.5) + geom_tippoint(aes(color=hosts), alpha=0.25)
p+theme(legend.position="right") + guides(color=guide_legend(title="Gelatinous host", reverse=T))
plot(hclust(amphi_dist))
c= tkplot(g, canvas.width = 700, canvas.height = 700, vertex.size = 2.8, layout=Lc, vertex.label.dist = 0.3, vertex.label.cex = 0.5)
tkplot.fit.to.screen(c, height = 500, width = 500)
tkplot.center(c)
a = tkplot(g, canvas.width = 700, canvas.height = 700, vertex.size = 2.8, layout=Lo, vertex.label.dist = 0.3, vertex.label.cex = 0.5)
tkplot.rotate(a, degree = 90)
tkplot.fit.to.screen(a, height = 500, width = 500)
tkplot.center(a)
