install.packages(c("phytools", "phangorn", "ape"))
install.packages("Bioconductor")
install.packages(c("dplyr", "tidyr", "reshape2", "ggplot2"))
source("https://bioconductor.org/biocLite.R")
biocLite('ggtree')
library("ape", lib.loc="/usr/local/lib/R/3.2/site-library")
library("ggplot2", lib.loc="/usr/local/lib/R/3.2/site-library")
library("ggtree")
library("phytools", lib.loc="/usr/local/lib/R/3.2/site-library")
library("phangorn", lib.loc="/usr/local/lib/R/3.2/site-library")
install.packages("geiger")
?ggtree
bioLite
biocLite("ggtree")
library(Bioconductor)
library(biocLite)
library(bioconductor)
source("https://bioconductor.org/biocLite.R")
?bicLite
?biocLite
biocLite("ggtree")
library('ggtree')
install.packages("devtools")
library(devtools)
install_github('ggbiplot', 'vcv')
install_github('ggbiplot/vcv')
install.packages("stringr")
library(devtools)
biocLite(ggtree)
install.packages("ggtree")
library('ggtree')
source("https://bioconductor.org/biocLite.R")
biocLite("ggtree")
source("https://bioconductor.org/biocLite.R")
biocLite("EBImage")
source("https://bioconductor.org/biocLite.R")
biocLite("fftwtools")
source("https://bioconductor.org/biocLite.R")
biocLite("ggtree")
?t
?qt
qt(1-0.1/2, 8999)
qt(1-0.1/2, 1999)
qt(1-0.1/2, 999)
sqrt(9000)
sqrt(1000)
1.645023/sqrt(9000)
1.64638/sqrt(1000)
qt(1-0.1/2, 49)
qt(1-0.1/2, 199)
sqrt(50)
sqrt(200)
(1.653/14.14)/(1.677/7.07)
qt(1-0.01/2, 39)
127.95+(2.707913*(24.03/sqrt(40)))
127.95-(2.707913*(24.03/sqrt(40)))
(2.707913*(24.03/sqrt(40)))
qt(1-0.01/2, 99)
2.626*5.8/10
(1-pt(3.96551, df = 99))
0.7805/41.1467
BG = read.tree("output/host18S_bayesian2_run_1.tree")
setwd("~/Documents/0BIOL_Phylogenetics/phylobio_final_project")
ass = unique(read.table("Associations.csv", sep = '\t', header = T)[,c(1,2)])
amphipods = sort(as.vector(unique(ass$amphipod)))
hosts = sort(as.vector(unique(ass$host)))
library(reshape2)
assmatrix = dcast(ass, amphipod~host, length)
rownames(assmatrix) = assmatrix[,1]
heatmap(as.matrix(assmatrix[,2:94]), col=c("white", "orange"), Rowv=NA, Colv=NA)
library(igraph)
treespp2013 = as.vector(read.table("Hurt2013spp.txt", sep = ",")[,1])
prunedmatrix = assmatrix[which(assmatrix$amphipod %in% treespp2013),]
prunedass = as.matrix(ass[which(ass$amphipod %in% treespp2013),])
heatmap(as.matrix(prunedmatrix[,2:94]), col=c("white", "orange"), Rowv=NA, Colv=NA)
library(ape)
library(phytools)
library(ggtree)
BG = read.tree("output/host18S_bayesian2_run_1.tree")
plot(BG)
nodelabels()
BG = read.tree("output/host18S_bayesian2_run_1.tree")
library(ape)
BG = read.nexus("output/host18S_bayesian2_run_1.tree")
plot(BG)
nodelabels()
BG = reroot(BG, 78)
plot(BG)
nodelabels()
BG = reroot(BG, 54)
plot(BG)
nodelabels()
BG = reroot(BG, 59)
plot(BG)
BG = read.nexus("output/host18S_bayesian2_run_1.tree")
plot(BG)
nodelabels()
BG = reroot(BG, 58)
plot(BG)
#GTR+Gamma Bayesian
BG = read.nexus("output/host18S_bayesian2_run_1.tree")
plot(BG)
nodelabels()
BG = reroot(BG, 75)
plot(BG)
TREE = BG
nodatatipnames = TREE$tip.label[which(!(TREE$tip.label %in% sharedspp))]
nodatatips = c(1:length(TREE$tip.label))[which(TREE$tip.label %in% nodatatipnames)]
prunedtree = drop.tip(TREE, nodatatips)
prunedtree$tip.label
plot(prunedtree)
ultram = chronos(prunedtree)
plot(ultram)
nodatatipnames = TREE$tip.label[which(!(TREE$tip.label %in% sharedspp))]
TREE$tip.label = str_replace_all(TREE$tip.label,'_',' ')
sharedspp = as.vector(prunedass[,2][which(prunedass[,2] %in% TREE$tip.label)])
nodatatipnames = TREE$tip.label[which(!(TREE$tip.label %in% sharedspp))]
nodatatips = c(1:length(TREE$tip.label))[which(TREE$tip.label %in% nodatatipnames)]
prunedtree = drop.tip(TREE, nodatatips)
prunedtree$tip.label
plot(prunedtree)
ultram = chronos(prunedtree)
plot(ultram)
plot(prunedtree)
TREE$tip.label = str_replace_all(TREE$tip.label,'_',' ')
library(stringr)
TREE$tip.label = str_replace_all(TREE$tip.label,'_',' ')
sharedspp = as.vector(prunedass[,2][which(prunedass[,2] %in% TREE$tip.label)])
nodatatipnames = TREE$tip.label[which(!(TREE$tip.label %in% sharedspp))]
nodatatips = c(1:length(TREE$tip.label))[which(TREE$tip.label %in% nodatatipnames)]
prunedtree = drop.tip(TREE, nodatatips)
prunedtree$tip.label
plot(prunedtree)
ultram = chronos(prunedtree)
plot(ultram)
prunedass[,2] = as.matrix(str_replace_all(prunedass[,2],'conica','sp.'))
reprunedass = as.matrix(prunedass[which(prunedass[,2] %in% ultram$tip.label),])
reprunedass = reprunedass[match(ultram$tip.label, reprunedass[,2]),]
reprunedassmatrix = as.matrix(dcast(as.data.frame(reprunedass), amphipod~host, length))
reprunedassmatrix = reprunedassmatrix[,2:16]
class(reprunedassmatrix) <- "numeric"
rownames(reprunedassmatrix) = dcast(as.data.frame(reprunedass), amphipod~host, length)[,1]
heatmap(reprunedassmatrix[,2:9], col=c("white", "orange"), Rowv=NA, Colv=NA)
ggtree(ultram, layout="circular") + geom_tiplab(aes(angle=angle), color='blue')
labeled = ultram
labeled$edge.length = labeled$edge.length * 10
dd = data.frame(taxa  = labeled$tip.label, amphipod = reprunedass[,1])
p = ggtree(labeled, layout="rectangular") + xlim(NA, 23)
p = p %<+% dd + geom_tiplab(aes(color=amphipod), show_guide = FALSE, size = 3.5) + geom_tippoint(aes(color=amphipod), alpha=0.25)
p+theme(legend.position="right") + guides(color=guide_legend(title="Amphipod", reverse=T))
