install.packages(c("phytools", "phangorn", "ape"))
install.packages("Bioconductor")
install.packages(c("dplyr", "tidyr", "reshape2", "ggplot2"))
source("https://bioconductor.org/biocLite.R")
biocLite('ggtree')
library("ape", lib.loc="/usr/local/lib/R/3.2/site-library")
library("ggplot2", lib.loc="/usr/local/lib/R/3.2/site-library")
library("ggtree")
library("phytools", lib.loc="/usr/local/lib/R/3.2/site-library")
library("phangorn", lib.loc="/usr/local/lib/R/3.2/site-library")
install.packages("geiger")
?ggtree
bioLite
biocLite("ggtree")
library(Bioconductor)
library(biocLite)
library(bioconductor)
source("https://bioconductor.org/biocLite.R")
?bicLite
?biocLite
biocLite("ggtree")
library('ggtree')
install.packages("devtools")
library(devtools)
install_github('ggbiplot', 'vcv')
install_github('ggbiplot/vcv')
install.packages("stringr")
library(devtools)
biocLite(ggtree)
install.packages("ggtree")
library('ggtree')
source("https://bioconductor.org/biocLite.R")
biocLite("ggtree")
source("https://bioconductor.org/biocLite.R")
biocLite("EBImage")
source("https://bioconductor.org/biocLite.R")
biocLite("fftwtools")
source("https://bioconductor.org/biocLite.R")
biocLite("ggtree")
?t
?qt
qt(1-0.1/2, 8999)
qt(1-0.1/2, 1999)
qt(1-0.1/2, 999)
sqrt(9000)
sqrt(1000)
1.645023/sqrt(9000)
1.64638/sqrt(1000)
qt(1-0.1/2, 49)
qt(1-0.1/2, 199)
sqrt(50)
sqrt(200)
(1.653/14.14)/(1.677/7.07)
qt(1-0.01/2, 39)
127.95+(2.707913*(24.03/sqrt(40)))
127.95-(2.707913*(24.03/sqrt(40)))
(2.707913*(24.03/sqrt(40)))
qt(1-0.01/2, 99)
2.626*5.8/10
(1-pt(3.96551, df = 99))
0.7805/41.1467
library(stringr)
library(ape)
library(phytools)
library(ggtree)
library(reshape2)
library(igraph)
library(picante)
setwd("~/Documents/0BIOL_Phylogenetics/phylobio_final_project")
ass = unique(read.table("Associations.csv", sep = '\t', header = T)[,c(1,2)])
amphipods = sort(as.vector(unique(ass$amphipod)))
hosts = sort(as.vector(unique(ass$host)))
assmatrix = dcast(ass, amphipod~host, length)
rownames(assmatrix) = assmatrix[,1]
heatmap(as.matrix(assmatrix[,2:94]), col=c("white", "orange"), Rowv=NA, Colv=NA)
amphipodML = read.tree("Amphipods/RAxML/RAxML_bipartitions.amphipodsCOI_MSAML_boot100")
plot(amphipodML)
treespp2013 = as.vector(read.table("Amphipods/Hurt2013spp.txt", sep = ",")[,1])
treespp2013
amphipodML$tip.label
treespp2013 = amphipodML$tip.label
prunedmatrix = assmatrix[which(assmatrix$amphipod %in% treespp2013),]
prunedass = as.matrix(ass[which(ass$amphipod %in% treespp2013),])
heatmap(as.matrix(prunedmatrix[,2:94]), col=c("white", "orange"), Rowv=NA, Colv=NA)
nodelabels()
amphipodML=reroot(amphipodML, 85)
plot(amphipodML)
nodelabels()
amphipodML = read.tree("Amphipods/RAxML/RAxML_bipartitions.amphipodsCOI_MSAML_boot100")
plot(amphipodML)
nodelabels()
amphipodML=reroot(amphipodML, 57)
amphipodML = read.tree("Amphipods/RAxML/RAxML_bipartitions.amphipodsCOI_MSAML_boot100")
plot(amphipodML)
nodelabels()
amphipodML = read.tree("Amphipods/RAxML/RAxML_bipartitions.amphipodsCOI_MSAML_boot100")
amphipodML = drop.tip(amphipodML, which(amphipodML$tip.label == "Cyathura sp." | amphipodML$tip.label == "Idotea sp."))
plot(amphipodML)
amphipodML = read.tree("Amphipods/RAxML/RAxML_bipartitions.amphipodsCOI_MSAML_boot100")
amphipodML = drop.tip(amphipodML, which(amphipodML$tip.label == "Cyathura_sp." | amphipodML$tip.label == "Idotea_sp."))
plot(amphipodML)
amphipodML = read.tree("Amphipods/RAxML/RAxML_bipartitions.amphipodsCOI_MSAML_boot100")
amphipodML = drop.tip(amphipodML, which(amphipodML$tip.label == "Cyathura_sp." | amphipodML$tip.label == "Idotea_sp."))
amphipodML$edge
nodelabels()
amphipodML=reroot(amphipodML, 52)
plot(amphipodML)
amphipodML$tip.label = str_replace_all(TREE$tip.label,'_',' ')
plot(amphipodML)
hostree = read.nexus("FirstHostRound/output/host18S_bayesian2_run_1.tree")
hostree$tip.label
extreeBAYES = read.nexus("ExtendedHosts/output/host_ext_MSA_bayesian_run_1.tree")
badtips = which(!(extreeBAYES$tip.label %in% hostree$tip.label))
hostBayes = drop.tip(extreeBAYES, badtips)
plot(hostBayes)
nodelabels()
hostBayes = reroot(hostBayes, 80)
plot(hostBayes)
TREE = hostBayes
TREE$tip.label = str_replace_all(TREE$tip.label,'_',' ')
amphipodML$tip.label = str_replace_all(TREE$tip.label,'_',' ')
#prune the matrix according to amphipod spp available in 2013 phylogeny
treespp2013 = amphipodML$tip.label
prunedmatrix = assmatrix[which(assmatrix$amphipod %in% treespp2013),]
prunedass = as.matrix(ass[which(ass$amphipod %in% treespp2013),])
heatmap(as.matrix(prunedmatrix[,2:94]), col=c("white", "orange"), Rowv=NA, Colv=NA)
amphipodML$tip.label
View(assmatrix)
which(assmatrix$amphipod %in% treespp2013)
assmatrix$amphipod
amphipodML = read.tree("Amphipods/RAxML/RAxML_bipartitions.amphipodsCOI_MSAML_boot100")
amphipodML = drop.tip(amphipodML, which(amphipodML$tip.label == "Cyathura_sp." | amphipodML$tip.label == "Idotea_sp."))
plot(amphipodML)
nodelabels()
amphipodML=reroot(amphipodML, 52)
plot(amphipodML)
TREE$tip.label = str_replace_all(TREE$tip.label,'_',' ')
amphipodML$tip.label = str_replace_all(amphipodML$tip.label,'_',' ')
treespp2013 = amphipodML$tip.label
prunedmatrix = assmatrix[which(assmatrix$amphipod %in% treespp2013),]
prunedass = as.matrix(ass[which(ass$amphipod %in% treespp2013),])
heatmap(as.matrix(prunedmatrix[,2:94]), col=c("white", "orange"), Rowv=NA, Colv=NA)
sharedspp = as.vector(prunedass[,2][which(prunedass[,2] %in% TREE$tip.label)])
#prune the tree with the shared species in association data and host tree
nodatatipnames = TREE$tip.label[which(!(TREE$tip.label %in% sharedspp))]
nodatatips = c(1:length(TREE$tip.label))[which(TREE$tip.label %in% nodatatipnames)]
prunedtree = drop.tip(TREE, nodatatips)
prunedtree$tip.label
plot(prunedtree)
ultram = chronos(prunedtree)
plot(ultram)
prunedass[,2] = as.matrix(str_replace_all(prunedass[,2],'conica','sp.'))
reprunedass = as.matrix(prunedass[which(prunedass[,2] %in% ultram$tip.label),])
reprunedass = reprunedass[match(ultram$tip.label, reprunedass[,2]),]
reprunedassmatrix = as.matrix(dcast(as.data.frame(reprunedass), amphipod~host, length))
reprunedassmatrix = reprunedassmatrix[,2:16]
class(reprunedassmatrix) <- "numeric"
rownames(reprunedassmatrix) = dcast(as.data.frame(reprunedass), amphipod~host, length)[,1]
heatmap(reprunedassmatrix[,2:9], col=c("white", "orange"), Rowv=NA, Colv=NA)
g <- graph_from_edgelist(as.matrix(reprunedass))
V(g)$color <- ifelse(V(g)$name %in% hosts, "lightblue", "red")
V(g)$label.color <- ifelse(V(g)$name %in% hosts, "blue", "darkred")
V(g)$types <- ifelse(V(g)$name %in% hosts, F, T)
Lo = layout_as_bipartite(g, types = V(g)$types, hgap = 15, vgap = 600)
a = tkplot(g, canvas.width = 700, canvas.height = 700, vertex.size = 2.8, layout=Lo, vertex.label.dist = 0.3, vertex.label.cex = 0.5)
tkplot.rotate(a, degree = 90)
tkplot.fit.to.screen(a, height = 500, width = 500)
tkplot.center(a)
